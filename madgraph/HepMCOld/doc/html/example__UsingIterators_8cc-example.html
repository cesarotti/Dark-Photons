<head>
<title>HepMC Reference Documentation </title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head>
<body bgcolor="#FFFFFF">

<!-------------------------------- Header ---------------------------->
<table width="100%" border="1" height="70" cellpadding="10">
  <tr bgcolor="#FFFFCC"> 
    <td width="16%" height="64" valign="middle" align="center" bgcolor="#FFFFCC">
     <!-- #BeginLibraryItem" -->
      <img src="http://spi.cern.ch//LCG logo.jpg" width="61" height="61">
     <!-- #EndLibraryItem --> 
    </td>
    <td width="84%" height="64" valign="middle" align="center">
	<h1>HepMC Reference Documentation</h1> 
	<a href=http://lcgapp.cern.ch/project/simu/HepMC/>HepMC</a>
    </td> 
  </tr>
</table>
<p>
<!-- Generated by Doxygen 1.5.1-3 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
    <li><a href="examples.html"><span>Examples</span></a></li>
  </ul>
</div>
<h1>example_UsingIterators.cc</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00002"></a>00002 <span class="comment">// Matt.Dobbs@Cern.CH, Feb 2000</span>
<a name="l00003"></a>00003 <span class="comment">// This example shows low to use the particle and vertex iterators</span>
<a name="l00005"></a>00005 <span class="comment"></span><span class="comment">// To Compile: go to the HepMC directory and type:</span>
<a name="l00006"></a>00006 <span class="comment">// gmake examples/example_UsingIterators.exe</span>
<a name="l00007"></a>00007 <span class="comment">//</span>
<a name="l00008"></a>00008 
<a name="l00009"></a>00009 <span class="preprocessor">#include "<a class="code" href="IO__Ascii_8h.html">HepMC/IO_Ascii.h</a>"</span>
<a name="l00010"></a>00010 <span class="preprocessor">#include "<a class="code" href="GenEvent_8h.html">HepMC/GenEvent.h</a>"</span>
<a name="l00011"></a>00011 <span class="preprocessor">#include &lt;math.h&gt;</span>
<a name="l00012"></a>00012 <span class="preprocessor">#include &lt;algorithm&gt;</span>
<a name="l00013"></a>00013 <span class="preprocessor">#include &lt;list&gt;</span>
<a name="l00014"></a>00014 
<a name="l00016"></a>00016 
<a name="l00020"></a>00020 <span class="keyword">class </span><a name="_a0"></a><a class="code" href="classIsPhoton.html" title="example class">IsPhoton</a> {
<a name="l00021"></a>00021 <span class="keyword">public</span>:
<a name="l00023"></a>00023     <span class="keywordtype">bool</span> <a name="a1"></a><a class="code" href="classIsPhoton.html#8ed40aa03fd51c1639078f75a0902f98" title="returns true if the GenParticle is a photon with more than 10 GeV transverse momentum...">operator()</a>( <span class="keyword">const</span> <a name="_a2"></a><a class="code" href="classHepMC_1_1GenParticle.html" title="The GenParticle class contains information about generated particles.">HepMC::GenParticle</a>* <a name="a3"></a><a class="code" href="PythiaWrapper5__720_8h.html#8e241458f851615b53df90ab6231f85e">p</a> ) { 
<a name="l00024"></a>00024         <span class="keywordflow">if</span> ( <a class="code" href="PythiaWrapper5__720_8h.html#8e241458f851615b53df90ab6231f85e">p</a>-&gt;pdg_id() == 22 
<a name="l00025"></a>00025              &amp;&amp; <a class="code" href="PythiaWrapper5__720_8h.html#8e241458f851615b53df90ab6231f85e">p</a>-&gt;momentum().perp() &gt; 10. ) <span class="keywordflow">return</span> 1;
<a name="l00026"></a>00026         <span class="keywordflow">return</span> 0;
<a name="l00027"></a>00027     }
<a name="l00028"></a>00028 };
<a name="l00029"></a>00029 
<a name="l00031"></a>00031 
<a name="l00034"></a>00034 <span class="keyword">class </span><a name="_a4"></a><a class="code" href="classIsW__Boson.html" title="example class">IsW_Boson</a> {
<a name="l00035"></a>00035 <span class="keyword">public</span>:
<a name="l00037"></a>00037     <span class="keywordtype">bool</span> <a name="a5"></a><a class="code" href="classIsW__Boson.html#206d7b0078c631b69c2cbc4c81846e55" title="returns true if the GenParticle is a W">operator()</a>( <span class="keyword">const</span> <a class="code" href="classHepMC_1_1GenParticle.html" title="The GenParticle class contains information about generated particles.">HepMC::GenParticle</a>* <a class="code" href="PythiaWrapper5__720_8h.html#8e241458f851615b53df90ab6231f85e">p</a> ) { 
<a name="l00038"></a>00038         <span class="keywordflow">if</span> ( abs(<a class="code" href="PythiaWrapper5__720_8h.html#8e241458f851615b53df90ab6231f85e">p</a>-&gt;pdg_id()) == 24 ) <span class="keywordflow">return</span> 1;
<a name="l00039"></a>00039         <span class="keywordflow">return</span> 0;
<a name="l00040"></a>00040     }
<a name="l00041"></a>00041 };
<a name="l00042"></a>00042 
<a name="l00044"></a>00044 
<a name="l00047"></a>00047 <span class="keyword">class </span><a name="_a6"></a><a class="code" href="classIsFinalState.html" title="example class">IsFinalState</a> {
<a name="l00048"></a>00048 <span class="keyword">public</span>:
<a name="l00050"></a>00050     <span class="keywordtype">bool</span> <a name="a7"></a><a class="code" href="classIsFinalState.html#62aeba27a39989c7bbccef8a0fa7626a" title="returns true if the GenParticle does not decay">operator()</a>( <span class="keyword">const</span> <a class="code" href="classHepMC_1_1GenParticle.html" title="The GenParticle class contains information about generated particles.">HepMC::GenParticle</a>* <a class="code" href="PythiaWrapper5__720_8h.html#8e241458f851615b53df90ab6231f85e">p</a> ) { 
<a name="l00051"></a>00051         <span class="keywordflow">if</span> ( !<a class="code" href="PythiaWrapper5__720_8h.html#8e241458f851615b53df90ab6231f85e">p</a>-&gt;end_vertex() &amp;&amp; <a class="code" href="PythiaWrapper5__720_8h.html#8e241458f851615b53df90ab6231f85e">p</a>-&gt;status()==1 ) <span class="keywordflow">return</span> 1;
<a name="l00052"></a>00052         <span class="keywordflow">return</span> 0;
<a name="l00053"></a>00053     }
<a name="l00054"></a>00054 };
<a name="l00055"></a>00055 
<a name="l00056"></a>00056 <span class="keywordtype">int</span> <a name="a8"></a><a class="code" href="example__BuildEventFromScratch_8cc.html#e66f6b31b5ad750f1fe042a706a4e3d4">main</a>() {
<a name="l00057"></a>00057     { <span class="comment">// begin scope of ascii_in</span>
<a name="l00058"></a>00058         <span class="comment">// an event has been prepared in advance for this example, read it</span>
<a name="l00059"></a>00059         <span class="comment">// into memory using the IO_Ascii input strategy</span>
<a name="l00060"></a>00060         <a name="_a9"></a><a class="code" href="classHepMC_1_1IO__Ascii.html" title="IO_Ascii is used to read or write from an ascii file.">HepMC::IO_Ascii</a> ascii_in(<span class="stringliteral">"example_UsingIterators.txt"</span>,std::ios::in);
<a name="l00061"></a>00061         <span class="keywordflow">if</span> ( ascii_in.rdstate() == std::ios::failbit ) {
<a name="l00062"></a>00062             std::cerr &lt;&lt; <span class="stringliteral">"ERROR input file example_UsingIterators.txt is needed "</span>
<a name="l00063"></a>00063                       &lt;&lt; <span class="stringliteral">"and does not exist. "</span>
<a name="l00064"></a>00064                       &lt;&lt; <span class="stringliteral">"\n Look for it in HepMC/examples, Exit."</span> &lt;&lt; std::endl;
<a name="l00065"></a>00065             <span class="keywordflow">return</span> 1;
<a name="l00066"></a>00066         }
<a name="l00067"></a>00067 
<a name="l00068"></a>00068         <a name="_a10"></a><a class="code" href="classHepMC_1_1GenEvent.html" title="The GenEvent class is the core of HepMC.">HepMC::GenEvent</a>* evt = ascii_in.read_next_event();
<a name="l00069"></a>00069 
<a name="l00070"></a>00070         <span class="comment">// if you wish to have a look at the event, then use evt-&gt;print();</span>
<a name="l00071"></a>00071 
<a name="l00072"></a>00072         <span class="comment">// use GenEvent::vertex_iterator to fill a list of all </span>
<a name="l00073"></a>00073         <span class="comment">// vertices in the event</span>
<a name="l00074"></a>00074         std::list&lt;HepMC::GenVertex*&gt; allvertices;
<a name="l00075"></a>00075         <span class="keywordflow">for</span> ( <a name="_a11"></a><a class="code" href="classHepMC_1_1GenEvent_1_1vertex__iterator.html" title="non-const vertex iterator">HepMC::GenEvent::vertex_iterator</a> <a name="a12"></a><a class="code" href="PythiaWrapper5__720_8h.html#015eddda8d78be6655b61bc37112c89c">v</a> = evt-&gt;<a name="a13"></a><a class="code" href="classHepMC_1_1GenEvent.html#f4cea6163a1a320ac732318ca89cd5bc" title="begin vertex iteration">vertices_begin</a>();
<a name="l00076"></a>00076               <a class="code" href="PythiaWrapper5__720_8h.html#015eddda8d78be6655b61bc37112c89c">v</a> != evt-&gt;<a name="a14"></a><a class="code" href="classHepMC_1_1GenEvent.html#a6fd4a90d8eb096f95215ad5c18d6a7c" title="end vertex iteration">vertices_end</a>(); ++<a class="code" href="PythiaWrapper5__720_8h.html#015eddda8d78be6655b61bc37112c89c">v</a> ) {
<a name="l00077"></a>00077             allvertices.push_back(*<a class="code" href="PythiaWrapper5__720_8h.html#015eddda8d78be6655b61bc37112c89c">v</a>);
<a name="l00078"></a>00078         }
<a name="l00079"></a>00079 
<a name="l00080"></a>00080         <span class="comment">// we could do the same thing with the STL algorithm copy</span>
<a name="l00081"></a>00081         std::list&lt;HepMC::GenVertex*&gt; allvertices2;
<a name="l00082"></a>00082         copy( evt-&gt;<a class="code" href="classHepMC_1_1GenEvent.html#f4cea6163a1a320ac732318ca89cd5bc" title="begin vertex iteration">vertices_begin</a>(), evt-&gt;<a class="code" href="classHepMC_1_1GenEvent.html#a6fd4a90d8eb096f95215ad5c18d6a7c" title="end vertex iteration">vertices_end</a>(), 
<a name="l00083"></a>00083               back_inserter(allvertices2) );
<a name="l00084"></a>00084 
<a name="l00085"></a>00085         <span class="comment">// fill a list of all final state particles in the event, by requiring</span>
<a name="l00086"></a>00086         <span class="comment">// that each particle satisfyies the IsFinalState predicate</span>
<a name="l00087"></a>00087         <a class="code" href="classIsFinalState.html" title="example class">IsFinalState</a> isfinal;
<a name="l00088"></a>00088         std::list&lt;HepMC::GenParticle*&gt; finalstateparticles;
<a name="l00089"></a>00089         <span class="keywordflow">for</span> ( <a name="_a15"></a><a class="code" href="classHepMC_1_1GenEvent_1_1particle__iterator.html" title="non-const particle iterator">HepMC::GenEvent::particle_iterator</a> <a class="code" href="PythiaWrapper5__720_8h.html#8e241458f851615b53df90ab6231f85e">p</a> = evt-&gt;<a name="a16"></a><a class="code" href="classHepMC_1_1GenEvent.html#a7e3c5e99982b837a5dddac952467919" title="begin particle iteration">particles_begin</a>();
<a name="l00090"></a>00090               <a class="code" href="PythiaWrapper5__720_8h.html#8e241458f851615b53df90ab6231f85e">p</a> != evt-&gt;<a name="a17"></a><a class="code" href="classHepMC_1_1GenEvent.html#facd3ef23718acc13770f2dc467836e9" title="end particle iteration">particles_end</a>(); ++<a class="code" href="PythiaWrapper5__720_8h.html#8e241458f851615b53df90ab6231f85e">p</a> ) {
<a name="l00091"></a>00091             <span class="keywordflow">if</span> ( isfinal(*<a class="code" href="PythiaWrapper5__720_8h.html#8e241458f851615b53df90ab6231f85e">p</a>) ) finalstateparticles.push_back(*p);
<a name="l00092"></a>00092         }
<a name="l00093"></a>00093 
<a name="l00094"></a>00094         <span class="comment">// an STL-like algorithm called HepMC::copy_if is provided in the</span>
<a name="l00095"></a>00095         <span class="comment">// GenEvent.h header to do this sort of operation more easily,</span>
<a name="l00096"></a>00096         <span class="comment">// you could get the identical results as above by using:</span>
<a name="l00097"></a>00097         std::list&lt;HepMC::GenParticle*&gt; finalstateparticles2;
<a name="l00098"></a>00098         <a name="a18"></a><a class="code" href="namespaceHepMC.html#a2956e1a6624e7d348ca38cca84c24ac" title="define the type of iterator to use">HepMC::copy_if</a>( evt-&gt;<a class="code" href="classHepMC_1_1GenEvent.html#a7e3c5e99982b837a5dddac952467919" title="begin particle iteration">particles_begin</a>(), evt-&gt;<a class="code" href="classHepMC_1_1GenEvent.html#facd3ef23718acc13770f2dc467836e9" title="end particle iteration">particles_end</a>(), 
<a name="l00099"></a>00099                         back_inserter(finalstateparticles2), <a class="code" href="classIsFinalState.html" title="example class">IsFinalState</a>() );
<a name="l00100"></a>00100 
<a name="l00101"></a>00101         <span class="comment">// lets print all photons in the event that satisfy the IsPhoton criteria</span>
<a name="l00102"></a>00102         <a class="code" href="classIsPhoton.html" title="example class">IsPhoton</a> isphoton;
<a name="l00103"></a>00103         <span class="keywordflow">for</span> ( <a class="code" href="classHepMC_1_1GenEvent_1_1particle__iterator.html" title="non-const particle iterator">HepMC::GenEvent::particle_iterator</a> p = evt-&gt;<a class="code" href="classHepMC_1_1GenEvent.html#a7e3c5e99982b837a5dddac952467919" title="begin particle iteration">particles_begin</a>();
<a name="l00104"></a>00104               p != evt-&gt;<a class="code" href="classHepMC_1_1GenEvent.html#facd3ef23718acc13770f2dc467836e9" title="end particle iteration">particles_end</a>(); ++p ) {
<a name="l00105"></a>00105             <span class="keywordflow">if</span> ( isphoton(*p) ) (*p)-&gt;print();
<a name="l00106"></a>00106         }
<a name="l00107"></a>00107 
<a name="l00108"></a>00108         <span class="comment">// the GenVertex::particle_iterator and GenVertex::vertex_iterator</span>
<a name="l00109"></a>00109         <span class="comment">// are slightly different from the GenEvent:: versions, in that</span>
<a name="l00110"></a>00110         <span class="comment">// the iterator starts at the given vertex, and walks through the attached </span>
<a name="l00111"></a>00111         <span class="comment">// vertex returning particles/vertices.</span>
<a name="l00112"></a>00112         <span class="comment">// Thus only particles/vertices which are in the same graph as the given</span>
<a name="l00113"></a>00113         <span class="comment">// vertex will be returned. A range is specified with these iterators,</span>
<a name="l00114"></a>00114         <span class="comment">// the choices are:</span>
<a name="l00115"></a>00115         <span class="comment">//    parents, children, family, ancestors, descendants, relatives </span>
<a name="l00116"></a>00116         <span class="comment">// here are some examples.</span>
<a name="l00117"></a>00117 
<a name="l00118"></a>00118         <span class="comment">// use GenEvent::particle_iterator to find all W's in the event,</span>
<a name="l00119"></a>00119         <span class="comment">// then </span>
<a name="l00120"></a>00120         <span class="comment">// (1) for each W user the GenVertex::particle_iterator with a range of</span>
<a name="l00121"></a>00121         <span class="comment">//     parents to return and print the immediate mothers of these W's.</span>
<a name="l00122"></a>00122         <span class="comment">// (2) for each W user the GenVertex::particle_iterator with a range of</span>
<a name="l00123"></a>00123         <span class="comment">//     descendants to return and print all descendants of these W's.</span>
<a name="l00124"></a>00124         <a class="code" href="classIsW__Boson.html" title="example class">IsW_Boson</a> isw;
<a name="l00125"></a>00125         <span class="keywordflow">for</span> ( <a class="code" href="classHepMC_1_1GenEvent_1_1particle__iterator.html" title="non-const particle iterator">HepMC::GenEvent::particle_iterator</a> p = evt-&gt;<a class="code" href="classHepMC_1_1GenEvent.html#a7e3c5e99982b837a5dddac952467919" title="begin particle iteration">particles_begin</a>();
<a name="l00126"></a>00126               p != evt-&gt;<a class="code" href="classHepMC_1_1GenEvent.html#facd3ef23718acc13770f2dc467836e9" title="end particle iteration">particles_end</a>(); ++p ) {
<a name="l00127"></a>00127             <span class="keywordflow">if</span> ( isw(*p) ) {
<a name="l00128"></a>00128                 std::cout &lt;&lt; <span class="stringliteral">"A W boson has been found: "</span> &lt;&lt; std::endl;
<a name="l00129"></a>00129                 (*p)-&gt;print();
<a name="l00130"></a>00130                 <span class="comment">// return all parents</span>
<a name="l00131"></a>00131                 <span class="comment">// we do this by pointing to the production vertex of the W </span>
<a name="l00132"></a>00132                 <span class="comment">// particle and asking for all particle parents of that vertex</span>
<a name="l00133"></a>00133                 std::cout &lt;&lt; <span class="stringliteral">"\t Its parents are: "</span> &lt;&lt; std::endl;
<a name="l00134"></a>00134                 <span class="keywordflow">if</span> ( (*p)-&gt;production_vertex() ) {
<a name="l00135"></a>00135                     <span class="keywordflow">for</span> ( <a name="_a19"></a><a class="code" href="classHepMC_1_1GenVertex_1_1particle__iterator.html" title="particle iterator">HepMC::GenVertex::particle_iterator</a> mother 
<a name="l00136"></a>00136                               = (*p)-&gt;production_vertex()-&gt;
<a name="l00137"></a>00137                               particles_begin(<a name="a20"></a><a class="code" href="namespaceHepMC.html#4bcb7cab15dc9b703a73e593c3a5e42950ded9ccf4b46b12aa937cbdfe79023c">HepMC::parents</a>);
<a name="l00138"></a>00138                           mother != (*p)-&gt;production_vertex()-&gt;
<a name="l00139"></a>00139                               particles_end(<a class="code" href="namespaceHepMC.html#4bcb7cab15dc9b703a73e593c3a5e42950ded9ccf4b46b12aa937cbdfe79023c">HepMC::parents</a>); 
<a name="l00140"></a>00140                           ++mother ) {
<a name="l00141"></a>00141                         std::cout &lt;&lt; <span class="stringliteral">"\t"</span>;
<a name="l00142"></a>00142                         (*mother)-&gt;print();
<a name="l00143"></a>00143                     }
<a name="l00144"></a>00144                 }
<a name="l00145"></a>00145                 <span class="comment">// return all descendants</span>
<a name="l00146"></a>00146                 <span class="comment">// we do this by pointing to the end vertex of the W </span>
<a name="l00147"></a>00147                 <span class="comment">// particle and asking for all particle descendants of that vertex</span>
<a name="l00148"></a>00148                 std::cout &lt;&lt; <span class="stringliteral">"\t\t Its descendants are: "</span> &lt;&lt; std::endl;
<a name="l00149"></a>00149                 <span class="keywordflow">if</span> ( (*p)-&gt;end_vertex() ) {
<a name="l00150"></a>00150                     <span class="keywordflow">for</span> ( <a class="code" href="classHepMC_1_1GenVertex_1_1particle__iterator.html" title="particle iterator">HepMC::GenVertex::particle_iterator</a> des 
<a name="l00151"></a>00151                               =(*p)-&gt;end_vertex()-&gt;
<a name="l00152"></a>00152                               particles_begin(<a name="a21"></a><a class="code" href="namespaceHepMC.html#4bcb7cab15dc9b703a73e593c3a5e429d64c86f9935a8dd45503b86ab66372ad">HepMC::descendants</a>);
<a name="l00153"></a>00153                           des != (*p)-&gt;end_vertex()-&gt;
<a name="l00154"></a>00154                               particles_end(<a class="code" href="namespaceHepMC.html#4bcb7cab15dc9b703a73e593c3a5e429d64c86f9935a8dd45503b86ab66372ad">HepMC::descendants</a>);
<a name="l00155"></a>00155                           ++des ) {
<a name="l00156"></a>00156                         std::cout &lt;&lt; <span class="stringliteral">"\t\t"</span>;
<a name="l00157"></a>00157                         (*des)-&gt;print();
<a name="l00158"></a>00158                     }
<a name="l00159"></a>00159                 }
<a name="l00160"></a>00160             }
<a name="l00161"></a>00161         }
<a name="l00162"></a>00162         <span class="comment">// cleanup</span>
<a name="l00163"></a>00163         <span class="keyword">delete</span> evt;
<a name="l00164"></a>00164         <span class="comment">// in analogy to the above, similar use can be made of the</span>
<a name="l00165"></a>00165         <span class="comment">// HepMC::GenVertex::vertex_iterator, which also accepts a range.</span>
<a name="l00166"></a>00166     } <span class="comment">// end scope of ascii_in</span>
<a name="l00167"></a>00167 
<a name="l00168"></a>00168     <span class="keywordflow">return</span> 0;
<a name="l00169"></a>00169 }
</pre></div> <hr size="1"><address style="text-align: right;"><small>Generated on Tue Oct 23 17:05:34 2007 for HepMC by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1-3 </small></address>
</body>
</html>
