<head>
<title>HepMC Reference Documentation </title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head>
<body bgcolor="#FFFFFF">

<!-------------------------------- Header ---------------------------->
<table width="100%" border="1" height="70" cellpadding="10">
  <tr bgcolor="#FFFFCC"> 
    <td width="16%" height="64" valign="middle" align="center" bgcolor="#FFFFCC">
     <!-- #BeginLibraryItem" -->
      <img src="http://spi.cern.ch//LCG logo.jpg" width="61" height="61">
     <!-- #EndLibraryItem --> 
    </td>
    <td width="84%" height="64" valign="middle" align="center">
	<h1>HepMC Reference Documentation</h1> 
	<a href=http://lcgapp.cern.ch/project/simu/HepMC/>HepMC</a>
    </td> 
  </tr>
</table>
<p>
<!-- Generated by Doxygen 1.5.1-3 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li class="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
    <li><a href="examples.html"><span>Examples</span></a></li>
  </ul>
</div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul>
</div>
<div class="nav">
<a class="el" href="dir_6f5e1fd014b545bac6b7a8ff1c591f69.html">src</a></div>
<h1>GenVertex.cc</h1><a href="GenVertex_8cc.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00002"></a>00002 <span class="comment">// Matt.Dobbs@Cern.CH, September 1999</span>
<a name="l00003"></a>00003 <span class="comment">// GenVertex within an event</span>
<a name="l00005"></a>00005 <span class="comment"></span>
<a name="l00006"></a>00006 <span class="preprocessor">#include "<a class="code" href="GenParticle_8h.html">HepMC/GenParticle.h</a>"</span>
<a name="l00007"></a>00007 <span class="preprocessor">#include "<a class="code" href="GenVertex_8h.html">HepMC/GenVertex.h</a>"</span>
<a name="l00008"></a>00008 <span class="preprocessor">#include "<a class="code" href="GenEvent_8h.html">HepMC/GenEvent.h</a>"</span>
<a name="l00009"></a>00009 <span class="preprocessor">#include "<a class="code" href="SearchVector_8h.html">HepMC/SearchVector.h</a>"</span>
<a name="l00010"></a>00010 <span class="preprocessor">#include &lt;iomanip&gt;</span>       <span class="comment">// needed for formatted output</span>
<a name="l00011"></a>00011 
<a name="l00012"></a>00012 <span class="keyword">namespace </span>HepMC {
<a name="l00013"></a>00013 
<a name="l00014"></a><a class="code" href="classHepMC_1_1GenVertex.html#46d11fb413ff0e5e9c1a49a1e1a544b3">00014</a>     <a class="code" href="classHepMC_1_1GenVertex.html#46d11fb413ff0e5e9c1a49a1e1a544b3" title="default constructor">GenVertex::GenVertex</a>( <span class="keyword">const</span> <a class="code" href="classHepMC_1_1FourVector.html" title="FourVector is a simple representation of a physics 4 vector.">FourVector</a>&amp; position,
<a name="l00015"></a>00015                           <span class="keywordtype">int</span> <span class="keywordtype">id</span>, <span class="keyword">const</span> <a class="code" href="classHepMC_1_1WeightContainer.html" title="Container for the Weights associated with an event or vertex.">WeightContainer</a>&amp; weights ) 
<a name="l00016"></a>00016         : m_position(position), m_id(id), m_weights(weights), m_event(0),
<a name="l00017"></a>00017           m_barcode(0)
<a name="l00018"></a>00018     {
<a name="l00019"></a>00019         s_counter++;
<a name="l00020"></a>00020     }
<a name="l00021"></a>00021 
<a name="l00022"></a><a class="code" href="classHepMC_1_1GenVertex.html#2b8b2c2f3f1cc483e804f9e89685ea99">00022</a>     GenVertex::GenVertex( <span class="keyword">const</span> <a class="code" href="classHepMC_1_1GenVertex.html" title="GenVertex contains information about decay vertices.">GenVertex</a>&amp; invertex ) 
<a name="l00023"></a>00023     : m_position( invertex.position() ),
<a name="l00024"></a>00024       m_particles_in(),
<a name="l00025"></a>00025       m_particles_out(),
<a name="l00026"></a>00026       m_id( invertex.id() ),
<a name="l00027"></a>00027       m_weights( invertex.weights() ),
<a name="l00028"></a>00028       m_event(0),
<a name="l00029"></a>00029       m_barcode(0) 
<a name="l00030"></a>00030     {
<a name="l00042"></a>00042         <span class="comment">//</span>
<a name="l00043"></a>00043         <span class="keywordflow">for</span> ( <a class="code" href="classHepMC_1_1GenVertex.html#2e35fbfa65f78e23ffa12416586e184f" title="const iterator for incoming particles">particles_in_const_iterator</a> 
<a name="l00044"></a>00044                   part1 = invertex.<a class="code" href="classHepMC_1_1GenVertex.html#78174e2e63c33a6d2d692eaa95a17c96" title="begin iteration of incoming particles">particles_in_const_begin</a>();
<a name="l00045"></a>00045               part1 != invertex.<a class="code" href="classHepMC_1_1GenVertex.html#6b119e549c11967b78092284f5df1049" title="end iteration of incoming particles">particles_in_const_end</a>(); ++part1 ) {
<a name="l00046"></a>00046             <span class="keywordflow">if</span> ( !(*part1)-&gt;production_vertex() ) { 
<a name="l00047"></a>00047                 <a class="code" href="classHepMC_1_1GenParticle.html" title="The GenParticle class contains information about generated particles.">GenParticle</a>* pin = <span class="keyword">new</span> <a class="code" href="classHepMC_1_1GenParticle.html" title="The GenParticle class contains information about generated particles.">GenParticle</a>(**part1);
<a name="l00048"></a>00048                 <a class="code" href="classHepMC_1_1GenVertex.html#62a329fbb235284e70c24e1bf7ba49e8" title="add incoming particle">add_particle_in</a>(pin);
<a name="l00049"></a>00049             }
<a name="l00050"></a>00050         }
<a name="l00051"></a>00051         <span class="keywordflow">for</span> ( <a class="code" href="classHepMC_1_1GenVertex.html#e7e6a5345877a846d81292f95b6e1c66" title="const iterator for outgoing particles">particles_out_const_iterator</a>
<a name="l00052"></a>00052                   part2 = invertex.<a class="code" href="classHepMC_1_1GenVertex.html#bc0e5428f131614bec06749450859950" title="begin iteration of outgoing particles">particles_out_const_begin</a>();
<a name="l00053"></a>00053               part2 != invertex.<a class="code" href="classHepMC_1_1GenVertex.html#ede4224d99108654c2b1f0ad2338c16b" title="end iteration of outgoing particles">particles_out_const_end</a>(); part2++ ) {
<a name="l00054"></a>00054             <a class="code" href="classHepMC_1_1GenParticle.html" title="The GenParticle class contains information about generated particles.">GenParticle</a>* pin = <span class="keyword">new</span> <a class="code" href="classHepMC_1_1GenParticle.html" title="The GenParticle class contains information about generated particles.">GenParticle</a>(**part2);
<a name="l00055"></a>00055             <a class="code" href="classHepMC_1_1GenVertex.html#eba71fdc7561e80fbbea2f60ac9358e7" title="add outgoing particle">add_particle_out</a>(pin);
<a name="l00056"></a>00056         }
<a name="l00057"></a>00057         <a class="code" href="classHepMC_1_1GenVertex.html#4a7c4b813633257318e9d8e5df720022" title="In general there is no reason to "suggest_barcode".">suggest_barcode</a>( invertex.<a class="code" href="classHepMC_1_1GenVertex.html#8f35affbf9e3bd00ed7a5ecbc0f5fb53" title="unique identifier">barcode</a>() );
<a name="l00058"></a>00058         <span class="comment">//</span>
<a name="l00059"></a>00059         s_counter++;
<a name="l00060"></a>00060     }
<a name="l00061"></a>00061     
<a name="l00062"></a><a class="code" href="classHepMC_1_1GenVertex.html#1e0f77dfb4fa3ec4f48bc631048f07d2">00062</a>     <a class="code" href="classHepMC_1_1GenVertex.html#1e0f77dfb4fa3ec4f48bc631048f07d2">GenVertex::~GenVertex</a>() {
<a name="l00063"></a>00063         <span class="comment">//</span>
<a name="l00064"></a>00064         <span class="comment">// need to delete any particles previously owned by this vertex</span>
<a name="l00065"></a>00065         <span class="keywordflow">if</span> ( <a class="code" href="classHepMC_1_1GenVertex.html#166e6d45b051f1cabcf607d93cbec0a1" title="pointer to the event that owns this vertex">parent_event</a>() ) <a class="code" href="classHepMC_1_1GenVertex.html#166e6d45b051f1cabcf607d93cbec0a1" title="pointer to the event that owns this vertex">parent_event</a>()-&gt;<a class="code" href="classHepMC_1_1GenEvent.html#03f0ec9f9e2adc00f5212b574c63ba0d" title="intended for use by GenParticle">remove_barcode</a>(<span class="keyword">this</span>);
<a name="l00066"></a>00066         <a class="code" href="classHepMC_1_1GenVertex.html#2cb256ec82025530b241c9be73429239" title="for internal use only">delete_adopted_particles</a>();
<a name="l00067"></a>00067         s_counter--;
<a name="l00068"></a>00068     }
<a name="l00069"></a>00069 
<a name="l00070"></a><a class="code" href="classHepMC_1_1GenVertex.html#90f8186f8d6745a884c7997b2ef086c9">00070</a>     <span class="keywordtype">void</span> <a class="code" href="classHepMC_1_1GenVertex.html#90f8186f8d6745a884c7997b2ef086c9" title="swap">GenVertex::swap</a>( <a class="code" href="classHepMC_1_1GenVertex.html" title="GenVertex contains information about decay vertices.">GenVertex</a> &amp; other)
<a name="l00071"></a>00071     {
<a name="l00072"></a>00072         m_position.<a class="code" href="classHepMC_1_1FourVector.html#ceaebca40c2dc3990f877c05867c6b21" title="swap">swap</a>( other.<a class="code" href="classHepMC_1_1GenVertex.html#737813663f1ba35c79ef8a5c70619c68">m_position</a> );
<a name="l00073"></a>00073         m_particles_in.swap( other.<a class="code" href="classHepMC_1_1GenVertex.html#1792980aede97fbbc47ae06291e4994d">m_particles_in</a> );
<a name="l00074"></a>00074         m_particles_out.swap( other.<a class="code" href="classHepMC_1_1GenVertex.html#ecbbe1967e95065281d51b69859d19ed">m_particles_out</a> );
<a name="l00075"></a>00075         std::swap( m_id, other.<a class="code" href="classHepMC_1_1GenVertex.html#513dfa950255c7de2706b1eae06a5f48">m_id</a> );
<a name="l00076"></a>00076         m_weights.<a class="code" href="classHepMC_1_1WeightContainer.html#b84491cd61e30b13f33dacc9c4ea6b0e" title="swap">swap</a>( other.<a class="code" href="classHepMC_1_1GenVertex.html#807079527f40992dcd93159e6c2e4128">m_weights</a> );
<a name="l00077"></a>00077         std::swap( m_event, other.<a class="code" href="classHepMC_1_1GenVertex.html#ce78d99ba615f4532f803d422993501c">m_event</a> );
<a name="l00078"></a>00078         std::swap( m_barcode, other.<a class="code" href="classHepMC_1_1GenVertex.html#f6598a5dab984cf3123d050df38133f2">m_barcode</a> );
<a name="l00079"></a>00079     }
<a name="l00080"></a>00080 
<a name="l00081"></a><a class="code" href="classHepMC_1_1GenVertex.html#e21c15d4609993733a25f96e82897a59">00081</a>     <a class="code" href="classHepMC_1_1GenVertex.html" title="GenVertex contains information about decay vertices.">GenVertex</a>&amp; <a class="code" href="classHepMC_1_1GenVertex.html#e21c15d4609993733a25f96e82897a59" title="shallow">GenVertex::operator=</a>( <span class="keyword">const</span> <a class="code" href="classHepMC_1_1GenVertex.html" title="GenVertex contains information about decay vertices.">GenVertex</a>&amp; invertex ) {
<a name="l00095"></a>00095 
<a name="l00096"></a>00096         <span class="comment">// best practices implementation</span>
<a name="l00097"></a>00097         <a class="code" href="classHepMC_1_1GenVertex.html" title="GenVertex contains information about decay vertices.">GenVertex</a> tmp( invertex );
<a name="l00098"></a>00098         <a class="code" href="classHepMC_1_1GenVertex.html#90f8186f8d6745a884c7997b2ef086c9" title="swap">swap</a>( tmp );
<a name="l00099"></a>00099         <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00100"></a>00100     }
<a name="l00101"></a>00101     
<a name="l00102"></a><a class="code" href="classHepMC_1_1GenVertex.html#5e83f5a50c0d514d9990a8d8b4aff810">00102</a>     <span class="keywordtype">bool</span> <a class="code" href="classHepMC_1_1GenVertex.html#5e83f5a50c0d514d9990a8d8b4aff810" title="equality">GenVertex::operator==</a>( <span class="keyword">const</span> <a class="code" href="classHepMC_1_1GenVertex.html" title="GenVertex contains information about decay vertices.">GenVertex</a>&amp; a )<span class="keyword"> const </span>{
<a name="l00108"></a>00108         <span class="comment">//</span>
<a name="l00109"></a>00109         <span class="keywordflow">if</span> ( a.<a class="code" href="classHepMC_1_1GenVertex.html#26d71cbe0c175febcc008edf18df004e" title="vertex position and time">position</a>() !=  this-&gt;<a class="code" href="classHepMC_1_1GenVertex.html#26d71cbe0c175febcc008edf18df004e" title="vertex position and time">position</a>() ) <span class="keywordflow">return</span> 0;
<a name="l00110"></a>00110         <span class="comment">// if the size of the inlist differs, return false.</span>
<a name="l00111"></a>00111         <span class="keywordflow">if</span> ( a.<a class="code" href="classHepMC_1_1GenVertex.html#b83aaf9a58ebf71e74fa7268d6da800f" title="number of incoming particles">particles_in_size</a>() !=  this-&gt;<a class="code" href="classHepMC_1_1GenVertex.html#b83aaf9a58ebf71e74fa7268d6da800f" title="number of incoming particles">particles_in_size</a>() ) <span class="keywordflow">return</span> 0;
<a name="l00112"></a>00112         <span class="comment">// if the size of the outlist differs, return false.</span>
<a name="l00113"></a>00113         <span class="keywordflow">if</span> ( a.<a class="code" href="classHepMC_1_1GenVertex.html#81ca013e478dd9eebd876b90036d5f8c" title="number of outgoing particles">particles_out_size</a>() !=  this-&gt;<a class="code" href="classHepMC_1_1GenVertex.html#81ca013e478dd9eebd876b90036d5f8c" title="number of outgoing particles">particles_out_size</a>() ) <span class="keywordflow">return</span> 0;
<a name="l00114"></a>00114         <span class="comment">// loop over the inlist and ensure particles are identical</span>
<a name="l00115"></a>00115         <span class="comment">//   (only do this if the lists aren't empty - we already know</span>
<a name="l00116"></a>00116         <span class="comment">//   if one isn't, then other isn't either!)</span>
<a name="l00117"></a>00117         <span class="keywordflow">if</span> ( a.<a class="code" href="classHepMC_1_1GenVertex.html#78174e2e63c33a6d2d692eaa95a17c96" title="begin iteration of incoming particles">particles_in_const_begin</a>() != a.<a class="code" href="classHepMC_1_1GenVertex.html#6b119e549c11967b78092284f5df1049" title="end iteration of incoming particles">particles_in_const_end</a>() ) {
<a name="l00118"></a>00118             <span class="keywordflow">for</span> ( <a class="code" href="classHepMC_1_1GenVertex.html#2e35fbfa65f78e23ffa12416586e184f" title="const iterator for incoming particles">GenVertex::particles_in_const_iterator</a> 
<a name="l00119"></a>00119                       ia = a.<a class="code" href="classHepMC_1_1GenVertex.html#78174e2e63c33a6d2d692eaa95a17c96" title="begin iteration of incoming particles">particles_in_const_begin</a>(),
<a name="l00120"></a>00120                       ib = this-&gt;<a class="code" href="classHepMC_1_1GenVertex.html#78174e2e63c33a6d2d692eaa95a17c96" title="begin iteration of incoming particles">particles_in_const_begin</a>();
<a name="l00121"></a>00121                   ia != a.<a class="code" href="classHepMC_1_1GenVertex.html#6b119e549c11967b78092284f5df1049" title="end iteration of incoming particles">particles_in_const_end</a>(); ia++, ib++ ){
<a name="l00122"></a>00122                 <span class="keywordflow">if</span> ( **ia != **ib ) <span class="keywordflow">return</span> 0;
<a name="l00123"></a>00123             }
<a name="l00124"></a>00124         }
<a name="l00125"></a>00125         <span class="comment">// loop over the outlist and ensure particles are identical</span>
<a name="l00126"></a>00126         <span class="comment">//   (only do this if the lists aren't empty - we already know</span>
<a name="l00127"></a>00127         <span class="comment">//   if one isn't, then other isn't either!)</span>
<a name="l00128"></a>00128         <span class="keywordflow">if</span> ( a.<a class="code" href="classHepMC_1_1GenVertex.html#bc0e5428f131614bec06749450859950" title="begin iteration of outgoing particles">particles_out_const_begin</a>() != a.<a class="code" href="classHepMC_1_1GenVertex.html#ede4224d99108654c2b1f0ad2338c16b" title="end iteration of outgoing particles">particles_out_const_end</a>() ) {
<a name="l00129"></a>00129             <span class="keywordflow">for</span> ( <a class="code" href="classHepMC_1_1GenVertex.html#e7e6a5345877a846d81292f95b6e1c66" title="const iterator for outgoing particles">GenVertex::particles_out_const_iterator</a> 
<a name="l00130"></a>00130                       ia = a.<a class="code" href="classHepMC_1_1GenVertex.html#bc0e5428f131614bec06749450859950" title="begin iteration of outgoing particles">particles_out_const_begin</a>(),
<a name="l00131"></a>00131                       ib = this-&gt;<a class="code" href="classHepMC_1_1GenVertex.html#bc0e5428f131614bec06749450859950" title="begin iteration of outgoing particles">particles_out_const_begin</a>();
<a name="l00132"></a>00132                   ia != a.<a class="code" href="classHepMC_1_1GenVertex.html#ede4224d99108654c2b1f0ad2338c16b" title="end iteration of outgoing particles">particles_out_const_end</a>(); ia++, ib++ ){
<a name="l00133"></a>00133                 <span class="keywordflow">if</span> ( **ia != **ib ) <span class="keywordflow">return</span> 0;
<a name="l00134"></a>00134             }
<a name="l00135"></a>00135         }
<a name="l00136"></a>00136         <span class="keywordflow">return</span> 1;
<a name="l00137"></a>00137     }
<a name="l00138"></a>00138 
<a name="l00139"></a><a class="code" href="classHepMC_1_1GenVertex.html#da667ea2640b27474c89c66ac51e1b6b">00139</a>     <span class="keywordtype">bool</span> <a class="code" href="classHepMC_1_1GenVertex.html#da667ea2640b27474c89c66ac51e1b6b" title="inequality">GenVertex::operator!=</a>( <span class="keyword">const</span> <a class="code" href="classHepMC_1_1GenVertex.html" title="GenVertex contains information about decay vertices.">GenVertex</a>&amp; a )<span class="keyword"> const </span>{
<a name="l00140"></a>00140         <span class="comment">// Returns true if the positions and lists of a and this are not equal.</span>
<a name="l00141"></a>00141         <span class="keywordflow">return</span> !( a == *this );
<a name="l00142"></a>00142     }  
<a name="l00143"></a>00143 
<a name="l00144"></a><a class="code" href="classHepMC_1_1GenVertex.html#6056715d054c2f22c33e5de4f35367a4">00144</a>     <span class="keywordtype">void</span> <a class="code" href="classHepMC_1_1GenVertex.html#6056715d054c2f22c33e5de4f35367a4" title="print vertex information">GenVertex::print</a>( std::ostream&amp; ostr )<span class="keyword"> const </span>{
<a name="l00145"></a>00145         <span class="keywordflow">if</span> ( <a class="code" href="classHepMC_1_1GenVertex.html#8f35affbf9e3bd00ed7a5ecbc0f5fb53" title="unique identifier">barcode</a>()!=0 ) {
<a name="l00146"></a>00146             <span class="keywordflow">if</span> ( <a class="code" href="classHepMC_1_1GenVertex.html#26d71cbe0c175febcc008edf18df004e" title="vertex position and time">position</a>() != <a class="code" href="classHepMC_1_1FourVector.html" title="FourVector is a simple representation of a physics 4 vector.">FourVector</a>(0,0,0,0) ) {
<a name="l00147"></a>00147                 ostr &lt;&lt; <span class="stringliteral">"Vertex:"</span>;
<a name="l00148"></a>00148                 ostr.width(9);
<a name="l00149"></a>00149                 ostr &lt;&lt; <a class="code" href="classHepMC_1_1GenVertex.html#8f35affbf9e3bd00ed7a5ecbc0f5fb53" title="unique identifier">barcode</a>();
<a name="l00150"></a>00150                 ostr &lt;&lt; <span class="stringliteral">" ID:"</span>;
<a name="l00151"></a>00151                 ostr.width(5);
<a name="l00152"></a>00152                 ostr &lt;&lt; <a class="code" href="classHepMC_1_1GenVertex.html#5ff1f18a5be422ebf023cf4e46a10a5d" title="vertex ID">id</a>();
<a name="l00153"></a>00153                 ostr &lt;&lt; <span class="stringliteral">" (X,cT)="</span>;
<a name="l00154"></a>00154                 ostr.width(9);
<a name="l00155"></a>00155                 ostr.precision(2);
<a name="l00156"></a>00156                 ostr.setf(std::ios::scientific, std::ios::floatfield);
<a name="l00157"></a>00157                 ostr.setf(std::ios_base::showpos);
<a name="l00158"></a>00158                 ostr &lt;&lt; <a class="code" href="classHepMC_1_1GenVertex.html#26d71cbe0c175febcc008edf18df004e" title="vertex position and time">position</a>().<a class="code" href="classHepMC_1_1FourVector.html#12f37f041844553e2a32e51af2eb000b" title="return x">x</a>() &lt;&lt; <span class="stringliteral">","</span>;
<a name="l00159"></a>00159                 ostr.width(9);
<a name="l00160"></a>00160                 ostr.precision(2);
<a name="l00161"></a>00161                 ostr &lt;&lt; <a class="code" href="classHepMC_1_1GenVertex.html#26d71cbe0c175febcc008edf18df004e" title="vertex position and time">position</a>().<a class="code" href="classHepMC_1_1FourVector.html#790b2dc07f9418bd484636ac15c38f0b" title="return y">y</a>() &lt;&lt; <span class="stringliteral">","</span>;
<a name="l00162"></a>00162                 ostr.width(9);
<a name="l00163"></a>00163                 ostr.precision(2);
<a name="l00164"></a>00164                 ostr &lt;&lt; <a class="code" href="classHepMC_1_1GenVertex.html#26d71cbe0c175febcc008edf18df004e" title="vertex position and time">position</a>().<a class="code" href="classHepMC_1_1FourVector.html#be35a1362e2c0c9267d8cf409dcfa36c" title="return z">z</a>() &lt;&lt; <span class="stringliteral">","</span>;
<a name="l00165"></a>00165                 ostr.width(9);
<a name="l00166"></a>00166                 ostr.precision(2);
<a name="l00167"></a>00167                 ostr &lt;&lt; <a class="code" href="classHepMC_1_1GenVertex.html#26d71cbe0c175febcc008edf18df004e" title="vertex position and time">position</a>().<a class="code" href="classHepMC_1_1FourVector.html#d354e1dfb4f1f21d688799674b152945" title="return t">t</a>();
<a name="l00168"></a>00168                 ostr.setf(std::ios::fmtflags(0), std::ios::floatfield);
<a name="l00169"></a>00169                 ostr.unsetf(std::ios_base::showpos);
<a name="l00170"></a>00170                 ostr &lt;&lt; std::endl;
<a name="l00171"></a>00171             } <span class="keywordflow">else</span> {
<a name="l00172"></a>00172                 ostr &lt;&lt; <span class="stringliteral">"GenVertex:"</span>;
<a name="l00173"></a>00173                 ostr.width(9);
<a name="l00174"></a>00174                 ostr &lt;&lt; <a class="code" href="classHepMC_1_1GenVertex.html#8f35affbf9e3bd00ed7a5ecbc0f5fb53" title="unique identifier">barcode</a>();
<a name="l00175"></a>00175                 ostr &lt;&lt; <span class="stringliteral">" ID:"</span>;
<a name="l00176"></a>00176                 ostr.width(5);
<a name="l00177"></a>00177                 ostr &lt;&lt; <a class="code" href="classHepMC_1_1GenVertex.html#5ff1f18a5be422ebf023cf4e46a10a5d" title="vertex ID">id</a>();
<a name="l00178"></a>00178                 ostr &lt;&lt; <span class="stringliteral">" (X,cT):0"</span>;
<a name="l00179"></a>00179                 ostr &lt;&lt; std::endl;
<a name="l00180"></a>00180             }
<a name="l00181"></a>00181         } <span class="keywordflow">else</span> {
<a name="l00182"></a>00182             <span class="comment">// If the vertex doesn't have a unique barcode assigned, then</span>
<a name="l00183"></a>00183             <span class="comment">//  we print its memory address instead... so that the</span>
<a name="l00184"></a>00184             <span class="comment">//  print out gives us a unique tag for the particle.</span>
<a name="l00185"></a>00185             <span class="keywordflow">if</span> ( <a class="code" href="classHepMC_1_1GenVertex.html#26d71cbe0c175febcc008edf18df004e" title="vertex position and time">position</a>() != <a class="code" href="classHepMC_1_1FourVector.html" title="FourVector is a simple representation of a physics 4 vector.">FourVector</a>(0,0,0,0) ) {
<a name="l00186"></a>00186                 ostr &lt;&lt; <span class="stringliteral">"Vertex:"</span>;
<a name="l00187"></a>00187                 ostr.width(9);
<a name="l00188"></a>00188                 ostr &lt;&lt; (<span class="keywordtype">void</span>*)<span class="keyword">this</span>;
<a name="l00189"></a>00189                 ostr &lt;&lt; <span class="stringliteral">" ID:"</span>;
<a name="l00190"></a>00190                 ostr.width(5);
<a name="l00191"></a>00191                 ostr &lt;&lt; <a class="code" href="classHepMC_1_1GenVertex.html#5ff1f18a5be422ebf023cf4e46a10a5d" title="vertex ID">id</a>();
<a name="l00192"></a>00192                 ostr &lt;&lt; <span class="stringliteral">" (X,cT)="</span>;
<a name="l00193"></a>00193                 ostr.width(9);
<a name="l00194"></a>00194                 ostr.precision(2);
<a name="l00195"></a>00195                 ostr.setf(std::ios::scientific, std::ios::floatfield);
<a name="l00196"></a>00196                 ostr.setf(std::ios_base::showpos);
<a name="l00197"></a>00197                 ostr &lt;&lt; <a class="code" href="classHepMC_1_1GenVertex.html#26d71cbe0c175febcc008edf18df004e" title="vertex position and time">position</a>().<a class="code" href="classHepMC_1_1FourVector.html#12f37f041844553e2a32e51af2eb000b" title="return x">x</a>();
<a name="l00198"></a>00198                 ostr.width(9);
<a name="l00199"></a>00199                 ostr.precision(2);
<a name="l00200"></a>00200                 ostr &lt;&lt; <a class="code" href="classHepMC_1_1GenVertex.html#26d71cbe0c175febcc008edf18df004e" title="vertex position and time">position</a>().<a class="code" href="classHepMC_1_1FourVector.html#790b2dc07f9418bd484636ac15c38f0b" title="return y">y</a>();
<a name="l00201"></a>00201                 ostr.width(9);
<a name="l00202"></a>00202                 ostr.precision(2);
<a name="l00203"></a>00203                 ostr &lt;&lt; <a class="code" href="classHepMC_1_1GenVertex.html#26d71cbe0c175febcc008edf18df004e" title="vertex position and time">position</a>().<a class="code" href="classHepMC_1_1FourVector.html#be35a1362e2c0c9267d8cf409dcfa36c" title="return z">z</a>();
<a name="l00204"></a>00204                 ostr.width(9);
<a name="l00205"></a>00205                 ostr.precision(2);
<a name="l00206"></a>00206                 ostr &lt;&lt; <a class="code" href="classHepMC_1_1GenVertex.html#26d71cbe0c175febcc008edf18df004e" title="vertex position and time">position</a>().<a class="code" href="classHepMC_1_1FourVector.html#d354e1dfb4f1f21d688799674b152945" title="return t">t</a>();
<a name="l00207"></a>00207                 ostr.setf(std::ios::fmtflags(0), std::ios::floatfield);
<a name="l00208"></a>00208                 ostr.unsetf(std::ios_base::showpos);
<a name="l00209"></a>00209                 ostr &lt;&lt; std::endl;
<a name="l00210"></a>00210             } <span class="keywordflow">else</span> {
<a name="l00211"></a>00211                 ostr &lt;&lt; <span class="stringliteral">"GenVertex:"</span>;
<a name="l00212"></a>00212                 ostr.width(9);
<a name="l00213"></a>00213                 ostr &lt;&lt; (<span class="keywordtype">void</span>*)<span class="keyword">this</span>;
<a name="l00214"></a>00214                 ostr &lt;&lt; <span class="stringliteral">" ID:"</span>;
<a name="l00215"></a>00215                 ostr.width(5);
<a name="l00216"></a>00216                 ostr &lt;&lt; <a class="code" href="classHepMC_1_1GenVertex.html#5ff1f18a5be422ebf023cf4e46a10a5d" title="vertex ID">id</a>();
<a name="l00217"></a>00217                 ostr &lt;&lt; <span class="stringliteral">" (X,cT):0"</span>;
<a name="l00218"></a>00218                 ostr &lt;&lt; std::endl;
<a name="l00219"></a>00219             }
<a name="l00220"></a>00220         }
<a name="l00221"></a>00221 
<a name="l00222"></a>00222         <span class="comment">// print the weights if there are any</span>
<a name="l00223"></a>00223         <span class="keywordflow">if</span> ( ! <a class="code" href="classHepMC_1_1GenVertex.html#8538e27b17b8ee6d57e458d473ffca24" title="direct access to the weights container is allowed.">weights</a>().empty() ) {
<a name="l00224"></a>00224             ostr &lt;&lt; <span class="stringliteral">" Wgts("</span> &lt;&lt; <a class="code" href="classHepMC_1_1GenVertex.html#8538e27b17b8ee6d57e458d473ffca24" title="direct access to the weights container is allowed.">weights</a>().<a class="code" href="classHepMC_1_1WeightContainer.html#43fbe772685a7052693a4bde78a2b93e" title="size of weight container">size</a>() &lt;&lt; <span class="stringliteral">")="</span>;
<a name="l00225"></a>00225             <span class="keywordflow">for</span> ( <a class="code" href="classHepMC_1_1WeightContainer.html#47336573f54b8e7e6f0622b02cdba497" title="const iterator for the weight container">WeightContainer::const_iterator</a> wgt = <a class="code" href="classHepMC_1_1GenVertex.html#8538e27b17b8ee6d57e458d473ffca24" title="direct access to the weights container is allowed.">weights</a>().begin();
<a name="l00226"></a>00226                   wgt != <a class="code" href="classHepMC_1_1GenVertex.html#8538e27b17b8ee6d57e458d473ffca24" title="direct access to the weights container is allowed.">weights</a>().<a class="code" href="classHepMC_1_1WeightContainer.html#972a0daa1bf368361f0fdcf4dc509460" title="end of the weight container">end</a>(); wgt++ ) { ostr &lt;&lt; *wgt &lt;&lt; <span class="stringliteral">" "</span>; }
<a name="l00227"></a>00227             ostr &lt;&lt; std::endl;
<a name="l00228"></a>00228         }
<a name="l00229"></a>00229         <span class="comment">// print out all the incoming, then outgoing particles</span>
<a name="l00230"></a>00230         <span class="keywordflow">for</span> ( <a class="code" href="classHepMC_1_1GenVertex.html#2e35fbfa65f78e23ffa12416586e184f" title="const iterator for incoming particles">particles_in_const_iterator</a> part1 = <a class="code" href="classHepMC_1_1GenVertex.html#78174e2e63c33a6d2d692eaa95a17c96" title="begin iteration of incoming particles">particles_in_const_begin</a>();
<a name="l00231"></a>00231               part1 != <a class="code" href="classHepMC_1_1GenVertex.html#6b119e549c11967b78092284f5df1049" title="end iteration of incoming particles">particles_in_const_end</a>(); part1++ ) {
<a name="l00232"></a>00232             <span class="keywordflow">if</span> ( part1 == <a class="code" href="classHepMC_1_1GenVertex.html#78174e2e63c33a6d2d692eaa95a17c96" title="begin iteration of incoming particles">particles_in_const_begin</a>() ) {
<a name="l00233"></a>00233                 ostr &lt;&lt; <span class="stringliteral">" I:"</span>;
<a name="l00234"></a>00234                 ostr.width(2);
<a name="l00235"></a>00235                 ostr &lt;&lt; m_particles_in.size();
<a name="l00236"></a>00236             } <span class="keywordflow">else</span> { ostr &lt;&lt; <span class="stringliteral">"     "</span>; }
<a name="l00237"></a>00237             <span class="comment">//(*part1)-&gt;print( ostr );  //uncomment for long debugging printout</span>
<a name="l00238"></a>00238             ostr &lt;&lt; **part1 &lt;&lt; std::endl;
<a name="l00239"></a>00239         }
<a name="l00240"></a>00240         <span class="keywordflow">for</span> ( <a class="code" href="classHepMC_1_1GenVertex.html#e7e6a5345877a846d81292f95b6e1c66" title="const iterator for outgoing particles">particles_out_const_iterator</a> part2 = <a class="code" href="classHepMC_1_1GenVertex.html#bc0e5428f131614bec06749450859950" title="begin iteration of outgoing particles">particles_out_const_begin</a>();
<a name="l00241"></a>00241               part2 != <a class="code" href="classHepMC_1_1GenVertex.html#ede4224d99108654c2b1f0ad2338c16b" title="end iteration of outgoing particles">particles_out_const_end</a>(); part2++ ) {
<a name="l00242"></a>00242             <span class="keywordflow">if</span> ( part2 == <a class="code" href="classHepMC_1_1GenVertex.html#bc0e5428f131614bec06749450859950" title="begin iteration of outgoing particles">particles_out_const_begin</a>() ) { 
<a name="l00243"></a>00243                 ostr &lt;&lt; <span class="stringliteral">" O:"</span>;
<a name="l00244"></a>00244                 ostr.width(2);
<a name="l00245"></a>00245                 ostr &lt;&lt; m_particles_out.size();
<a name="l00246"></a>00246             } <span class="keywordflow">else</span> { ostr &lt;&lt; <span class="stringliteral">"     "</span>; }
<a name="l00247"></a>00247             <span class="comment">//(*part2)-&gt;print( ostr ); // uncomment for long debugging printout</span>
<a name="l00248"></a>00248             ostr &lt;&lt; **part2 &lt;&lt; std::endl;
<a name="l00249"></a>00249         }
<a name="l00250"></a>00250     }
<a name="l00251"></a>00251 
<a name="l00252"></a><a class="code" href="classHepMC_1_1GenVertex.html#b91dee95f6e017a4c1c8f9f9d7c3cb76">00252</a>     <span class="keywordtype">double</span> <a class="code" href="classHepMC_1_1GenVertex.html#b91dee95f6e017a4c1c8f9f9d7c3cb76" title="|Sum (mom_in-mom_out)|">GenVertex::check_momentum_conservation</a>()<span class="keyword"> const </span>{
<a name="l00256"></a>00256         <span class="keywordtype">double</span> sumpx = 0, sumpy = 0, sumpz = 0;
<a name="l00257"></a>00257         <span class="keywordflow">for</span> ( <a class="code" href="classHepMC_1_1GenVertex.html#2e35fbfa65f78e23ffa12416586e184f" title="const iterator for incoming particles">particles_in_const_iterator</a> part1 = <a class="code" href="classHepMC_1_1GenVertex.html#78174e2e63c33a6d2d692eaa95a17c96" title="begin iteration of incoming particles">particles_in_const_begin</a>();
<a name="l00258"></a>00258               part1 != <a class="code" href="classHepMC_1_1GenVertex.html#6b119e549c11967b78092284f5df1049" title="end iteration of incoming particles">particles_in_const_end</a>(); part1++ ) {
<a name="l00259"></a>00259             sumpx   += (*part1)-&gt;momentum().px();
<a name="l00260"></a>00260             sumpy   += (*part1)-&gt;momentum().py();
<a name="l00261"></a>00261             sumpz   += (*part1)-&gt;momentum().pz();
<a name="l00262"></a>00262         }
<a name="l00263"></a>00263         <span class="keywordflow">for</span> ( <a class="code" href="classHepMC_1_1GenVertex.html#e7e6a5345877a846d81292f95b6e1c66" title="const iterator for outgoing particles">particles_out_const_iterator</a> part2 = <a class="code" href="classHepMC_1_1GenVertex.html#bc0e5428f131614bec06749450859950" title="begin iteration of outgoing particles">particles_out_const_begin</a>();
<a name="l00264"></a>00264               part2 != <a class="code" href="classHepMC_1_1GenVertex.html#ede4224d99108654c2b1f0ad2338c16b" title="end iteration of outgoing particles">particles_out_const_end</a>(); part2++ ) {
<a name="l00265"></a>00265             sumpx   -= (*part2)-&gt;momentum().px();
<a name="l00266"></a>00266             sumpy   -= (*part2)-&gt;momentum().py();
<a name="l00267"></a>00267             sumpz   -= (*part2)-&gt;momentum().pz();
<a name="l00268"></a>00268         }
<a name="l00269"></a>00269         <span class="keywordflow">return</span> sqrt( sumpx*sumpx + sumpy*sumpy + sumpz*sumpz );
<a name="l00270"></a>00270     }
<a name="l00271"></a>00271 
<a name="l00272"></a><a class="code" href="classHepMC_1_1GenVertex.html#62a329fbb235284e70c24e1bf7ba49e8">00272</a>     <span class="keywordtype">void</span> <a class="code" href="classHepMC_1_1GenVertex.html#62a329fbb235284e70c24e1bf7ba49e8" title="add incoming particle">GenVertex::add_particle_in</a>( <a class="code" href="classHepMC_1_1GenParticle.html" title="The GenParticle class contains information about generated particles.">GenParticle</a>* inparticle ) {
<a name="l00273"></a>00273         <span class="keywordflow">if</span> ( !inparticle ) <span class="keywordflow">return</span>;
<a name="l00274"></a>00274         <span class="comment">// if inparticle previously had a decay vertex, remove it from that</span>
<a name="l00275"></a>00275         <span class="comment">// vertex's list</span>
<a name="l00276"></a>00276         <span class="keywordflow">if</span> ( inparticle-&gt;<a class="code" href="classHepMC_1_1GenParticle.html#23a0feadeb701ccc0fe992cd02a8fe8e" title="pointer to the decay vertex">end_vertex</a>() ) {
<a name="l00277"></a>00277             inparticle-&gt;<a class="code" href="classHepMC_1_1GenParticle.html#23a0feadeb701ccc0fe992cd02a8fe8e" title="pointer to the decay vertex">end_vertex</a>()-&gt;<a class="code" href="classHepMC_1_1GenVertex.html#fe2129b7d97d47195d54b4e57b781d8c" title="for internal use only - remove particle from incoming list">remove_particle_in</a>( inparticle );
<a name="l00278"></a>00278         }
<a name="l00279"></a>00279         m_particles_in.push_back( inparticle );
<a name="l00280"></a>00280         inparticle-&gt;<a class="code" href="classHepMC_1_1GenParticle.html#f96a32a284976342a6b0721636a33966" title="set decay vertex">set_end_vertex_</a>( <span class="keyword">this</span> );
<a name="l00281"></a>00281     }
<a name="l00282"></a>00282 
<a name="l00283"></a><a class="code" href="classHepMC_1_1GenVertex.html#eba71fdc7561e80fbbea2f60ac9358e7">00283</a>     <span class="keywordtype">void</span> <a class="code" href="classHepMC_1_1GenVertex.html#eba71fdc7561e80fbbea2f60ac9358e7" title="add outgoing particle">GenVertex::add_particle_out</a>( <a class="code" href="classHepMC_1_1GenParticle.html" title="The GenParticle class contains information about generated particles.">GenParticle</a>* outparticle ) {
<a name="l00284"></a>00284         <span class="keywordflow">if</span> ( !outparticle ) <span class="keywordflow">return</span>;
<a name="l00285"></a>00285         <span class="comment">// if outparticle previously had a production vertex,</span>
<a name="l00286"></a>00286         <span class="comment">// remove it from that vertex's list</span>
<a name="l00287"></a>00287         <span class="keywordflow">if</span> ( outparticle-&gt;<a class="code" href="classHepMC_1_1GenParticle.html#c4ff8209f2528b3150c8b489fa4d991a" title="pointer to the production vertex">production_vertex</a>() ) {
<a name="l00288"></a>00288             outparticle-&gt;<a class="code" href="classHepMC_1_1GenParticle.html#c4ff8209f2528b3150c8b489fa4d991a" title="pointer to the production vertex">production_vertex</a>()-&gt;<a class="code" href="classHepMC_1_1GenVertex.html#47712412bb58b0af37ac00ba2fba82ba" title="for internal use only - remove particle from outgoing list">remove_particle_out</a>( outparticle );
<a name="l00289"></a>00289         }
<a name="l00290"></a>00290         m_particles_out.push_back( outparticle );
<a name="l00291"></a>00291         outparticle-&gt;<a class="code" href="classHepMC_1_1GenParticle.html#4706f11b418dc7a9cec65c83a71bac53" title="set production vertex">set_production_vertex_</a>( <span class="keyword">this</span> );
<a name="l00292"></a>00292     }
<a name="l00293"></a>00293 
<a name="l00294"></a><a class="code" href="classHepMC_1_1GenVertex.html#212c6b38f5e924285e207ae1295007b9">00294</a>     <a class="code" href="classHepMC_1_1GenParticle.html" title="The GenParticle class contains information about generated particles.">GenParticle</a>* <a class="code" href="classHepMC_1_1GenVertex.html#212c6b38f5e924285e207ae1295007b9" title="remove a particle">GenVertex::remove_particle</a>( <a class="code" href="classHepMC_1_1GenParticle.html" title="The GenParticle class contains information about generated particles.">GenParticle</a>* particle ) {
<a name="l00304"></a>00304         <span class="keywordflow">if</span> ( !particle ) <span class="keywordflow">return</span> 0;
<a name="l00305"></a>00305         <span class="keywordflow">if</span> ( particle-&gt;<a class="code" href="classHepMC_1_1GenParticle.html#23a0feadeb701ccc0fe992cd02a8fe8e" title="pointer to the decay vertex">end_vertex</a>() == this ) {
<a name="l00306"></a>00306             particle-&gt;<a class="code" href="classHepMC_1_1GenParticle.html#f96a32a284976342a6b0721636a33966" title="set decay vertex">set_end_vertex_</a>( 0 );
<a name="l00307"></a>00307             <a class="code" href="classHepMC_1_1GenVertex.html#fe2129b7d97d47195d54b4e57b781d8c" title="for internal use only - remove particle from incoming list">remove_particle_in</a>(particle);
<a name="l00308"></a>00308         }
<a name="l00309"></a>00309         <span class="keywordflow">if</span> ( particle-&gt;<a class="code" href="classHepMC_1_1GenParticle.html#c4ff8209f2528b3150c8b489fa4d991a" title="pointer to the production vertex">production_vertex</a>() == this ) {
<a name="l00310"></a>00310             particle-&gt;<a class="code" href="classHepMC_1_1GenParticle.html#4706f11b418dc7a9cec65c83a71bac53" title="set production vertex">set_production_vertex_</a>(0);
<a name="l00311"></a>00311             <a class="code" href="classHepMC_1_1GenVertex.html#47712412bb58b0af37ac00ba2fba82ba" title="for internal use only - remove particle from outgoing list">remove_particle_out</a>(particle);
<a name="l00312"></a>00312         }
<a name="l00313"></a>00313         <span class="keywordflow">return</span> particle;
<a name="l00314"></a>00314     }
<a name="l00315"></a>00315 
<a name="l00316"></a><a class="code" href="classHepMC_1_1GenVertex.html#fe2129b7d97d47195d54b4e57b781d8c">00316</a>     <span class="keywordtype">void</span> <a class="code" href="classHepMC_1_1GenVertex.html#fe2129b7d97d47195d54b4e57b781d8c" title="for internal use only - remove particle from incoming list">GenVertex::remove_particle_in</a>( <a class="code" href="classHepMC_1_1GenParticle.html" title="The GenParticle class contains information about generated particles.">GenParticle</a>* particle ) {
<a name="l00318"></a>00318         <span class="keywordflow">if</span> ( !particle ) <span class="keywordflow">return</span>;
<a name="l00319"></a>00319         m_particles_in.erase( <a class="code" href="namespaceHepMC.html#3e02b8a6f1eda9e14a62ae30f32235e1">already_in_vector</a>( &amp;m_particles_in, particle ) );
<a name="l00320"></a>00320     }
<a name="l00321"></a>00321 
<a name="l00322"></a><a class="code" href="classHepMC_1_1GenVertex.html#47712412bb58b0af37ac00ba2fba82ba">00322</a>     <span class="keywordtype">void</span> <a class="code" href="classHepMC_1_1GenVertex.html#47712412bb58b0af37ac00ba2fba82ba" title="for internal use only - remove particle from outgoing list">GenVertex::remove_particle_out</a>( <a class="code" href="classHepMC_1_1GenParticle.html" title="The GenParticle class contains information about generated particles.">GenParticle</a>* particle ) {
<a name="l00324"></a>00324         <span class="keywordflow">if</span> ( !particle ) <span class="keywordflow">return</span>;
<a name="l00325"></a>00325         m_particles_out.erase( <a class="code" href="namespaceHepMC.html#3e02b8a6f1eda9e14a62ae30f32235e1">already_in_vector</a>( &amp;m_particles_out, particle ) );
<a name="l00326"></a>00326     }
<a name="l00327"></a>00327 
<a name="l00328"></a><a class="code" href="classHepMC_1_1GenVertex.html#2cb256ec82025530b241c9be73429239">00328</a>     <span class="keywordtype">void</span> <a class="code" href="classHepMC_1_1GenVertex.html#2cb256ec82025530b241c9be73429239" title="for internal use only">GenVertex::delete_adopted_particles</a>() {
<a name="l00331"></a>00331         <span class="comment">//</span>
<a name="l00332"></a>00332         <span class="keywordflow">if</span> ( m_particles_out.empty() &amp;&amp; m_particles_in.empty() ) <span class="keywordflow">return</span>;
<a name="l00333"></a>00333         <span class="comment">// 1. delete all outgoing particles which don't have decay vertices.</span>
<a name="l00334"></a>00334         <span class="comment">//    those that do become the responsibility of the decay vertex</span>
<a name="l00335"></a>00335         <span class="comment">//    and have their productionvertex pointer set to NULL</span>
<a name="l00336"></a>00336         <span class="keywordflow">for</span> ( std::vector&lt;GenParticle*&gt;::iterator part1 = m_particles_out.begin();
<a name="l00337"></a>00337               part1 != m_particles_out.end(); ) {
<a name="l00338"></a>00338             <span class="keywordflow">if</span> ( !(*part1)-&gt;end_vertex() ) {
<a name="l00339"></a>00339                 <span class="keyword">delete</span> *(part1++);
<a name="l00340"></a>00340             } <span class="keywordflow">else</span> { 
<a name="l00341"></a>00341                 (*part1)-&gt;set_production_vertex_(0);
<a name="l00342"></a>00342                 ++part1;
<a name="l00343"></a>00343             }
<a name="l00344"></a>00344         }
<a name="l00345"></a>00345         m_particles_out.clear();
<a name="l00346"></a>00346         <span class="comment">//</span>
<a name="l00347"></a>00347         <span class="comment">// 2. delete all incoming particles which don't have production</span>
<a name="l00348"></a>00348         <span class="comment">//    vertices. those that do become the responsibility of the </span>
<a name="l00349"></a>00349         <span class="comment">//    production vertex and have their decayvertex pointer set to NULL</span>
<a name="l00350"></a>00350         <span class="keywordflow">for</span> ( std::vector&lt;GenParticle*&gt;::iterator part2 = m_particles_in.begin();
<a name="l00351"></a>00351               part2 != m_particles_in.end(); ) {
<a name="l00352"></a>00352             <span class="keywordflow">if</span> ( !(*part2)-&gt;production_vertex() ) { 
<a name="l00353"></a>00353                 <span class="keyword">delete</span> *(part2++);
<a name="l00354"></a>00354             } <span class="keywordflow">else</span> { 
<a name="l00355"></a>00355                 (*part2)-&gt;set_end_vertex_(0); 
<a name="l00356"></a>00356                 ++part2;
<a name="l00357"></a>00357             }
<a name="l00358"></a>00358         }
<a name="l00359"></a>00359         m_particles_in.clear();
<a name="l00360"></a>00360     }
<a name="l00361"></a>00361 
<a name="l00362"></a><a class="code" href="classHepMC_1_1GenVertex.html#4a7c4b813633257318e9d8e5df720022">00362</a>     <span class="keywordtype">bool</span> <a class="code" href="classHepMC_1_1GenVertex.html#4a7c4b813633257318e9d8e5df720022" title="In general there is no reason to "suggest_barcode".">GenVertex::suggest_barcode</a>( <span class="keywordtype">int</span> the_bar_code )
<a name="l00363"></a>00363     {
<a name="l00373"></a>00373         <span class="keywordflow">if</span> ( the_bar_code &gt;0 ) {
<a name="l00374"></a>00374             std::cerr &lt;&lt; <span class="stringliteral">"GenVertex::suggest_barcode WARNING, vertex bar codes"</span>
<a name="l00375"></a>00375                       &lt;&lt; <span class="stringliteral">"\n MUST be negative integers. Positive integers "</span>
<a name="l00376"></a>00376                       &lt;&lt; <span class="stringliteral">"\n are reserved for particles only. Your suggestion "</span>
<a name="l00377"></a>00377                       &lt;&lt; <span class="stringliteral">"\n has been rejected."</span> &lt;&lt; std::endl;
<a name="l00378"></a>00378             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00379"></a>00379         }
<a name="l00380"></a>00380         <span class="keywordtype">bool</span> success = <span class="keyword">false</span>;
<a name="l00381"></a>00381         <span class="keywordflow">if</span> ( <a class="code" href="classHepMC_1_1GenVertex.html#166e6d45b051f1cabcf607d93cbec0a1" title="pointer to the event that owns this vertex">parent_event</a>() ) {
<a name="l00382"></a>00382             success = <a class="code" href="classHepMC_1_1GenVertex.html#166e6d45b051f1cabcf607d93cbec0a1" title="pointer to the event that owns this vertex">parent_event</a>()-&gt;<a class="code" href="classHepMC_1_1GenEvent.html#a91f815859d75cb9976f49d32a9b39c8" title="set the barcode - intended for use by GenParticle">set_barcode</a>( <span class="keyword">this</span>, the_bar_code );
<a name="l00383"></a>00383         } <span class="keywordflow">else</span> { <a class="code" href="classHepMC_1_1GenVertex.html#6e614efa2fa1e94b7a2bf5a128141138" title="set identifier">set_barcode_</a>( the_bar_code ); }
<a name="l00384"></a>00384         <span class="keywordflow">return</span> success;
<a name="l00385"></a>00385     }
<a name="l00386"></a>00386 
<a name="l00387"></a><a class="code" href="classHepMC_1_1GenVertex.html#70076beb6b1ac29693ba1f3a3296582f">00387</a>     <span class="keywordtype">void</span> <a class="code" href="classHepMC_1_1GenVertex.html#70076beb6b1ac29693ba1f3a3296582f" title="set parent event">GenVertex::set_parent_event_</a>( <a class="code" href="classHepMC_1_1GenEvent.html" title="The GenEvent class is the core of HepMC.">GenEvent</a>* new_evt ) 
<a name="l00388"></a>00388     { 
<a name="l00389"></a>00389         <a class="code" href="classHepMC_1_1GenEvent.html" title="The GenEvent class is the core of HepMC.">GenEvent</a>* orig_evt = m_event;
<a name="l00390"></a>00390         m_event = new_evt; 
<a name="l00391"></a>00391         <span class="comment">//</span>
<a name="l00392"></a>00392         <span class="comment">// every time a vertex's parent event changes, the map of barcodes</span>
<a name="l00393"></a>00393         <span class="comment">//   in the new and old parent event needs to be modified to </span>
<a name="l00394"></a>00394         <span class="comment">//   reflect this</span>
<a name="l00395"></a>00395         <span class="keywordflow">if</span> ( orig_evt != new_evt ) {
<a name="l00396"></a>00396             <span class="keywordflow">if</span> (new_evt) new_evt-&gt;<a class="code" href="classHepMC_1_1GenEvent.html#a91f815859d75cb9976f49d32a9b39c8" title="set the barcode - intended for use by GenParticle">set_barcode</a>( <span class="keyword">this</span>, <a class="code" href="classHepMC_1_1GenVertex.html#8f35affbf9e3bd00ed7a5ecbc0f5fb53" title="unique identifier">barcode</a>() );
<a name="l00397"></a>00397             <span class="keywordflow">if</span> (orig_evt) orig_evt-&gt;<a class="code" href="classHepMC_1_1GenEvent.html#03f0ec9f9e2adc00f5212b574c63ba0d" title="intended for use by GenParticle">remove_barcode</a>( <span class="keyword">this</span> );
<a name="l00398"></a>00398             <span class="comment">// we also need to loop over all the particles which are owned by </span>
<a name="l00399"></a>00399             <span class="comment">//  this vertex, and remove their barcodes from the old event.</span>
<a name="l00400"></a>00400             <span class="keywordflow">for</span> ( <a class="code" href="classHepMC_1_1GenVertex.html#2e35fbfa65f78e23ffa12416586e184f" title="const iterator for incoming particles">particles_in_const_iterator</a> part1=<a class="code" href="classHepMC_1_1GenVertex.html#78174e2e63c33a6d2d692eaa95a17c96" title="begin iteration of incoming particles">particles_in_const_begin</a>();
<a name="l00401"></a>00401                   part1 != <a class="code" href="classHepMC_1_1GenVertex.html#6b119e549c11967b78092284f5df1049" title="end iteration of incoming particles">particles_in_const_end</a>(); part1++ ) {
<a name="l00402"></a>00402                 <span class="keywordflow">if</span> ( !(*part1)-&gt;production_vertex() ) { 
<a name="l00403"></a>00403                     <span class="keywordflow">if</span> ( orig_evt ) orig_evt-&gt;remove_barcode( *part1 );
<a name="l00404"></a>00404                     <span class="keywordflow">if</span> ( new_evt ) new_evt-&gt;set_barcode( *part1, 
<a name="l00405"></a>00405                                                          (*part1)-&gt;barcode() );
<a name="l00406"></a>00406                 }
<a name="l00407"></a>00407             }
<a name="l00408"></a>00408             <span class="keywordflow">for</span> ( <a class="code" href="classHepMC_1_1GenVertex.html#e7e6a5345877a846d81292f95b6e1c66" title="const iterator for outgoing particles">particles_out_const_iterator</a>
<a name="l00409"></a>00409                       part2 = <a class="code" href="classHepMC_1_1GenVertex.html#bc0e5428f131614bec06749450859950" title="begin iteration of outgoing particles">particles_out_const_begin</a>();
<a name="l00410"></a>00410                   part2 != <a class="code" href="classHepMC_1_1GenVertex.html#ede4224d99108654c2b1f0ad2338c16b" title="end iteration of outgoing particles">particles_out_const_end</a>(); part2++ ) {
<a name="l00411"></a>00411                     <span class="keywordflow">if</span> ( orig_evt ) orig_evt-&gt;remove_barcode( *part2 );
<a name="l00412"></a>00412                     <span class="keywordflow">if</span> ( new_evt ) new_evt-&gt;set_barcode( *part2, 
<a name="l00413"></a>00413                                                          (*part2)-&gt;barcode() );
<a name="l00414"></a>00414             }
<a name="l00415"></a>00415         }
<a name="l00416"></a>00416     }
<a name="l00417"></a>00417 
<a name="l00419"></a>00419     <span class="comment">// Static  //</span>
<a name="l00421"></a><a class="code" href="classHepMC_1_1GenVertex.html#105ebb0a8012ebe900f1f5b173cfa90d">00421</a> <span class="comment"></span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classHepMC_1_1GenVertex.html#105ebb0a8012ebe900f1f5b173cfa90d" title="temporary for debugging">GenVertex::counter</a>() { <span class="keywordflow">return</span> s_counter; }
<a name="l00422"></a>00422     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> GenVertex::s_counter = 0; 
<a name="l00423"></a>00423 
<a name="l00425"></a>00425     <span class="comment">// Friends //</span>
<a name="l00427"></a>00427 <span class="comment"></span>
<a name="l00429"></a><a class="code" href="namespaceHepMC.html#a42d2c61c6cd87742cd7eec2eeb2b2c4">00429</a>     std::ostream&amp; <a class="code" href="classHepMC_1_1GenVertex.html#c8733007ea5ce97a0ba3d568a587bc5d" title="print vertex information">operator&lt;&lt;</a>( std::ostream&amp; ostr, <span class="keyword">const</span> <a class="code" href="classHepMC_1_1GenVertex.html" title="GenVertex contains information about decay vertices.">GenVertex</a>&amp; vtx ) {
<a name="l00430"></a>00430         <span class="keywordflow">if</span> ( vtx.<a class="code" href="classHepMC_1_1GenVertex.html#8f35affbf9e3bd00ed7a5ecbc0f5fb53" title="unique identifier">barcode</a>()!=0 ) ostr &lt;&lt; <span class="stringliteral">"BarCode "</span> &lt;&lt; vtx.<a class="code" href="classHepMC_1_1GenVertex.html#8f35affbf9e3bd00ed7a5ecbc0f5fb53" title="unique identifier">barcode</a>();
<a name="l00431"></a>00431         <span class="keywordflow">else</span> ostr &lt;&lt; <span class="stringliteral">"Address "</span> &lt;&lt; &amp;vtx;
<a name="l00432"></a>00432         ostr &lt;&lt; <span class="stringliteral">" (X,cT)="</span>;
<a name="l00433"></a>00433         <span class="keywordflow">if</span> ( vtx.position() != <a class="code" href="classHepMC_1_1FourVector.html" title="FourVector is a simple representation of a physics 4 vector.">FourVector</a>(0,0,0,0)) {
<a name="l00434"></a>00434             ostr &lt;&lt; vtx.<a class="code" href="classHepMC_1_1GenVertex.html#26d71cbe0c175febcc008edf18df004e" title="vertex position and time">position</a>().<a class="code" href="classHepMC_1_1FourVector.html#12f37f041844553e2a32e51af2eb000b" title="return x">x</a>() &lt;&lt; <span class="stringliteral">","</span>
<a name="l00435"></a>00435                  &lt;&lt; vtx.position().y() &lt;&lt; <span class="stringliteral">","</span>
<a name="l00436"></a>00436                  &lt;&lt; vtx.position().z() &lt;&lt; <span class="stringliteral">","</span>
<a name="l00437"></a>00437                  &lt;&lt; vtx.position().t();
<a name="l00438"></a>00438         } <span class="keywordflow">else</span> { ostr &lt;&lt; 0; }
<a name="l00439"></a>00439         ostr &lt;&lt; <span class="stringliteral">" #in:"</span> &lt;&lt; vtx.particles_in_size()
<a name="l00440"></a>00440              &lt;&lt; <span class="stringliteral">" #out:"</span> &lt;&lt; vtx.particles_out_size();
<a name="l00441"></a>00441         <span class="keywordflow">return</span> ostr;
<a name="l00442"></a>00442     }
<a name="l00443"></a>00443 
<a name="l00445"></a>00445     <span class="comment">// edge_iterator           // (protected - for internal use only)</span>
<a name="l00447"></a>00447 <span class="comment"></span>    <span class="comment">// If the user wants the functionality of the edge_iterator, he should</span>
<a name="l00448"></a>00448     <span class="comment">// use particle_iterator with IteratorRange = family, parents, or children</span>
<a name="l00449"></a>00449     <span class="comment">//</span>
<a name="l00450"></a>00450 
<a name="l00451"></a><a class="code" href="classHepMC_1_1GenVertex_1_1edge__iterator.html#cf00762381cf18f6edc090cc3c720491">00451</a>     <a class="code" href="classHepMC_1_1GenVertex_1_1edge__iterator.html#cf00762381cf18f6edc090cc3c720491">GenVertex::edge_iterator::edge_iterator</a>() : m_vertex(0), m_range(<a class="code" href="namespaceHepMC.html#4bcb7cab15dc9b703a73e593c3a5e42966aca6b4ed534f4cd10b29a86b4137d1">family</a>), 
<a name="l00452"></a>00452         m_is_inparticle_iter(0), m_is_past_end(1)
<a name="l00453"></a>00453     {}
<a name="l00454"></a>00454 
<a name="l00455"></a><a class="code" href="classHepMC_1_1GenVertex_1_1edge__iterator.html#1809c321aeb1a906c9f9757109d4f731">00455</a>     <a class="code" href="classHepMC_1_1GenVertex_1_1edge__iterator.html#cf00762381cf18f6edc090cc3c720491">GenVertex::edge_iterator::edge_iterator</a>( <span class="keyword">const</span> <a class="code" href="classHepMC_1_1GenVertex.html" title="GenVertex contains information about decay vertices.">GenVertex</a>&amp; vtx, 
<a name="l00456"></a>00456                                           <a class="code" href="namespaceHepMC.html#4bcb7cab15dc9b703a73e593c3a5e429" title="type of iteration">IteratorRange</a> range ) :
<a name="l00457"></a>00457         m_vertex(&amp;vtx), m_range(<a class="code" href="namespaceHepMC.html#4bcb7cab15dc9b703a73e593c3a5e42966aca6b4ed534f4cd10b29a86b4137d1">family</a>) 
<a name="l00458"></a>00458     {
<a name="l00459"></a>00459         <span class="comment">// Note: (26.1.2000) the original version of edge_iterator inheritted</span>
<a name="l00460"></a>00460         <span class="comment">//       from set&lt;GenParticle*&gt;::const_iterator() rather than using</span>
<a name="l00461"></a>00461         <span class="comment">//       composition as it does now.</span>
<a name="l00462"></a>00462         <span class="comment">//       The inheritted version suffered from a strange bug, which</span>
<a name="l00463"></a>00463         <span class="comment">//       I have not fully understood --- it only occurred after many</span>
<a name="l00464"></a>00464         <span class="comment">//       events were processed and only when I called the delete </span>
<a name="l00465"></a>00465         <span class="comment">//       function on past events. I believe it had something to do with</span>
<a name="l00466"></a>00466         <span class="comment">//       the past the end values, which are now robustly coded in this</span>
<a name="l00467"></a>00467         <span class="comment">//       version as boolean members.</span>
<a name="l00468"></a>00468         <span class="comment">//</span>
<a name="l00469"></a>00469         <span class="comment">// default range is family, only other choices are children/parents</span>
<a name="l00470"></a>00470         <span class="comment">//    descendants/ancestors not allowed &amp; recasted ot children/parents</span>
<a name="l00471"></a>00471         <span class="keywordflow">if</span> ( range == <a class="code" href="namespaceHepMC.html#4bcb7cab15dc9b703a73e593c3a5e429d64c86f9935a8dd45503b86ab66372ad">descendants</a> || range == <a class="code" href="namespaceHepMC.html#4bcb7cab15dc9b703a73e593c3a5e42959a13a228459c4a4bc3a2751b6ce858b">children</a> ) m_range = <a class="code" href="namespaceHepMC.html#4bcb7cab15dc9b703a73e593c3a5e42959a13a228459c4a4bc3a2751b6ce858b">children</a>;
<a name="l00472"></a>00472         <span class="keywordflow">if</span> ( range == <a class="code" href="namespaceHepMC.html#4bcb7cab15dc9b703a73e593c3a5e4294c4b09ce4f125d6f325edc553ebeac85">ancestors</a>   || range == <a class="code" href="namespaceHepMC.html#4bcb7cab15dc9b703a73e593c3a5e42950ded9ccf4b46b12aa937cbdfe79023c">parents</a>  ) m_range = <a class="code" href="namespaceHepMC.html#4bcb7cab15dc9b703a73e593c3a5e42950ded9ccf4b46b12aa937cbdfe79023c">parents</a>;
<a name="l00473"></a>00473         <span class="comment">//</span>
<a name="l00474"></a>00474         <span class="keywordflow">if</span> ( m_vertex-&gt;<a class="code" href="classHepMC_1_1GenVertex.html#1792980aede97fbbc47ae06291e4994d">m_particles_in</a>.empty() &amp;&amp;
<a name="l00475"></a>00475              m_vertex-&gt;<a class="code" href="classHepMC_1_1GenVertex.html#ecbbe1967e95065281d51b69859d19ed">m_particles_out</a>.empty() ) {
<a name="l00476"></a>00476             <span class="comment">// Case: particles_in and particles_out is empty.</span>
<a name="l00477"></a>00477             m_is_inparticle_iter = 0;
<a name="l00478"></a>00478             m_is_past_end = 1;
<a name="l00479"></a>00479         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( m_range == <a class="code" href="namespaceHepMC.html#4bcb7cab15dc9b703a73e593c3a5e42950ded9ccf4b46b12aa937cbdfe79023c">parents</a> &amp;&amp; m_vertex-&gt;<a class="code" href="classHepMC_1_1GenVertex.html#1792980aede97fbbc47ae06291e4994d">m_particles_in</a>.empty() ){
<a name="l00480"></a>00480             <span class="comment">// Case: particles in is empty and parents is requested.</span>
<a name="l00481"></a>00481             m_is_inparticle_iter = 1;
<a name="l00482"></a>00482             m_is_past_end = 1;
<a name="l00483"></a>00483         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( m_range == <a class="code" href="namespaceHepMC.html#4bcb7cab15dc9b703a73e593c3a5e42959a13a228459c4a4bc3a2751b6ce858b">children</a> &amp;&amp; m_vertex-&gt;<a class="code" href="classHepMC_1_1GenVertex.html#ecbbe1967e95065281d51b69859d19ed">m_particles_out</a>.empty() ){
<a name="l00484"></a>00484             <span class="comment">// Case: particles out is empty and children is requested.</span>
<a name="l00485"></a>00485             m_is_inparticle_iter = 0;
<a name="l00486"></a>00486             m_is_past_end = 1;
<a name="l00487"></a>00487         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( m_range == <a class="code" href="namespaceHepMC.html#4bcb7cab15dc9b703a73e593c3a5e42959a13a228459c4a4bc3a2751b6ce858b">children</a> ) {
<a name="l00488"></a>00488             <span class="comment">// Case: particles out is NOT empty, and children is requested</span>
<a name="l00489"></a>00489             m_set_iter = m_vertex-&gt;<a class="code" href="classHepMC_1_1GenVertex.html#ecbbe1967e95065281d51b69859d19ed">m_particles_out</a>.begin();
<a name="l00490"></a>00490             m_is_inparticle_iter = 0;
<a name="l00491"></a>00491             m_is_past_end = 0;
<a name="l00492"></a>00492         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( m_range == <a class="code" href="namespaceHepMC.html#4bcb7cab15dc9b703a73e593c3a5e42966aca6b4ed534f4cd10b29a86b4137d1">family</a> &amp;&amp; m_vertex-&gt;<a class="code" href="classHepMC_1_1GenVertex.html#1792980aede97fbbc47ae06291e4994d">m_particles_in</a>.empty() ) {
<a name="l00493"></a>00493             <span class="comment">// Case: particles in is empty, particles out is NOT empty,</span>
<a name="l00494"></a>00494             <span class="comment">//       and family is requested. Then skip ahead to partilces out.</span>
<a name="l00495"></a>00495             m_set_iter = m_vertex-&gt;<a class="code" href="classHepMC_1_1GenVertex.html#ecbbe1967e95065281d51b69859d19ed">m_particles_out</a>.begin();
<a name="l00496"></a>00496             m_is_inparticle_iter = 0;
<a name="l00497"></a>00497             m_is_past_end = 0;
<a name="l00498"></a>00498         } <span class="keywordflow">else</span> {
<a name="l00499"></a>00499             <span class="comment">// Normal scenario: start with the first incoming particle</span>
<a name="l00500"></a>00500             m_set_iter = m_vertex-&gt;<a class="code" href="classHepMC_1_1GenVertex.html#1792980aede97fbbc47ae06291e4994d">m_particles_in</a>.begin();
<a name="l00501"></a>00501             m_is_inparticle_iter = 1;
<a name="l00502"></a>00502             m_is_past_end = 0;
<a name="l00503"></a>00503         }
<a name="l00504"></a>00504     }
<a name="l00505"></a>00505 
<a name="l00506"></a><a class="code" href="classHepMC_1_1GenVertex_1_1edge__iterator.html#8cf25fc644886531908c70e868cada4f">00506</a>     <a class="code" href="classHepMC_1_1GenVertex_1_1edge__iterator.html#cf00762381cf18f6edc090cc3c720491">GenVertex::edge_iterator::edge_iterator</a>( <span class="keyword">const</span> <a class="code" href="classHepMC_1_1GenVertex_1_1edge__iterator.html" title="edge iterator">edge_iterator</a>&amp; <a class="code" href="PythiaWrapper5__720_8h.html#8e241458f851615b53df90ab6231f85e">p</a> ) {
<a name="l00507"></a>00507         *<span class="keyword">this</span> = <a class="code" href="PythiaWrapper5__720_8h.html#8e241458f851615b53df90ab6231f85e">p</a>;
<a name="l00508"></a>00508     }
<a name="l00509"></a>00509 
<a name="l00510"></a><a class="code" href="classHepMC_1_1GenVertex_1_1edge__iterator.html#31b36c14fbdf57e0e7d7fe41fe7f8d51">00510</a>     <a class="code" href="classHepMC_1_1GenVertex_1_1edge__iterator.html#31b36c14fbdf57e0e7d7fe41fe7f8d51">GenVertex::edge_iterator::~edge_iterator</a>() {}
<a name="l00511"></a>00511 
<a name="l00512"></a><a class="code" href="classHepMC_1_1GenVertex_1_1edge__iterator.html#c6f9265ebb8a9844b12a7ed007448e26">00512</a>     <a class="code" href="classHepMC_1_1GenVertex_1_1edge__iterator.html" title="edge iterator">GenVertex::edge_iterator</a>&amp; <a class="code" href="classHepMC_1_1GenVertex_1_1edge__iterator.html#c6f9265ebb8a9844b12a7ed007448e26" title="make a copy">GenVertex::edge_iterator::operator=</a>(
<a name="l00513"></a>00513         <span class="keyword">const</span> <a class="code" href="classHepMC_1_1GenVertex_1_1edge__iterator.html" title="edge iterator">edge_iterator</a>&amp; <a class="code" href="PythiaWrapper5__720_8h.html#8e241458f851615b53df90ab6231f85e">p</a> ) {
<a name="l00514"></a>00514         m_vertex = <a class="code" href="PythiaWrapper5__720_8h.html#8e241458f851615b53df90ab6231f85e">p</a>.m_vertex;
<a name="l00515"></a>00515         m_range = <a class="code" href="PythiaWrapper5__720_8h.html#8e241458f851615b53df90ab6231f85e">p</a>.m_range;
<a name="l00516"></a>00516         m_set_iter = <a class="code" href="PythiaWrapper5__720_8h.html#8e241458f851615b53df90ab6231f85e">p</a>.m_set_iter;
<a name="l00517"></a>00517         m_is_inparticle_iter = <a class="code" href="PythiaWrapper5__720_8h.html#8e241458f851615b53df90ab6231f85e">p</a>.m_is_inparticle_iter;
<a name="l00518"></a>00518         m_is_past_end = <a class="code" href="PythiaWrapper5__720_8h.html#8e241458f851615b53df90ab6231f85e">p</a>.m_is_past_end;
<a name="l00519"></a>00519         <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00520"></a>00520     }
<a name="l00521"></a>00521 
<a name="l00522"></a><a class="code" href="classHepMC_1_1GenVertex_1_1edge__iterator.html#e2556402e58ff8a8cccbbf3532cb1d15">00522</a>     <a class="code" href="classHepMC_1_1GenParticle.html" title="The GenParticle class contains information about generated particles.">GenParticle</a>* <a class="code" href="classHepMC_1_1GenVertex_1_1edge__iterator.html#e2556402e58ff8a8cccbbf3532cb1d15" title="return a pointer to a particle">GenVertex::edge_iterator::operator*</a>(<span class="keywordtype">void</span>)<span class="keyword"> const </span>{
<a name="l00523"></a>00523         <span class="keywordflow">if</span> ( !m_vertex || m_is_past_end ) <span class="keywordflow">return</span> 0;
<a name="l00524"></a>00524         <span class="keywordflow">return</span> *m_set_iter;
<a name="l00525"></a>00525     }
<a name="l00526"></a>00526 
<a name="l00527"></a><a class="code" href="classHepMC_1_1GenVertex_1_1edge__iterator.html#f3c926b96624a094b8b9c935d9f769b3">00527</a>     <a class="code" href="classHepMC_1_1GenVertex_1_1edge__iterator.html" title="edge iterator">GenVertex::edge_iterator</a>&amp; <a class="code" href="classHepMC_1_1GenVertex_1_1edge__iterator.html#f3c926b96624a094b8b9c935d9f769b3" title="Pre-fix increment.">GenVertex::edge_iterator::operator++</a>(<span class="keywordtype">void</span>){
<a name="l00528"></a>00528         <span class="comment">// Pre-fix increment</span>
<a name="l00529"></a>00529         <span class="comment">//</span>
<a name="l00530"></a>00530         <span class="comment">// increment the set iterator (unless we're past the end value)</span>
<a name="l00531"></a>00531         <span class="keywordflow">if</span> ( m_is_past_end ) <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00532"></a>00532         ++m_set_iter;
<a name="l00533"></a>00533         <span class="comment">// handle cases where m_set_iter points past the end</span>
<a name="l00534"></a>00534         <span class="keywordflow">if</span> ( m_range == <a class="code" href="namespaceHepMC.html#4bcb7cab15dc9b703a73e593c3a5e42966aca6b4ed534f4cd10b29a86b4137d1">family</a> &amp;&amp; m_is_inparticle_iter &amp;&amp;
<a name="l00535"></a>00535              m_set_iter == m_vertex-&gt;<a class="code" href="classHepMC_1_1GenVertex.html#1792980aede97fbbc47ae06291e4994d">m_particles_in</a>.end() ) {
<a name="l00536"></a>00536             <span class="comment">// at the end on in particle set, and range is family, so move to</span>
<a name="l00537"></a>00537             <span class="comment">// out particle set</span>
<a name="l00538"></a>00538             m_set_iter = m_vertex-&gt;<a class="code" href="classHepMC_1_1GenVertex.html#ecbbe1967e95065281d51b69859d19ed">m_particles_out</a>.begin();
<a name="l00539"></a>00539             m_is_inparticle_iter = 0;
<a name="l00540"></a>00540         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( m_range == <a class="code" href="namespaceHepMC.html#4bcb7cab15dc9b703a73e593c3a5e42950ded9ccf4b46b12aa937cbdfe79023c">parents</a> &amp;&amp; 
<a name="l00541"></a>00541                     m_set_iter == m_vertex-&gt;<a class="code" href="classHepMC_1_1GenVertex.html#1792980aede97fbbc47ae06291e4994d">m_particles_in</a>.end() ) {
<a name="l00542"></a>00542             <span class="comment">// at the end on in particle set, and range is parents only, so</span>
<a name="l00543"></a>00543             <span class="comment">// move into past the end state</span>
<a name="l00544"></a>00544             m_is_past_end = 1;
<a name="l00545"></a>00545         } 
<a name="l00546"></a>00546         <span class="comment">// the following is not else if because we might have range=family</span>
<a name="l00547"></a>00547         <span class="comment">// with an empty particles_out set.     </span>
<a name="l00548"></a>00548         <span class="keywordflow">if</span> ( m_set_iter == m_vertex-&gt;<a class="code" href="classHepMC_1_1GenVertex.html#ecbbe1967e95065281d51b69859d19ed">m_particles_out</a>.end() ) {
<a name="l00549"></a>00549             <span class="comment">//whenever out particles end is reached, go into past the end state</span>
<a name="l00550"></a>00550             m_is_past_end = 1;
<a name="l00551"></a>00551         }
<a name="l00552"></a>00552         <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00553"></a>00553     }
<a name="l00554"></a>00554 
<a name="l00555"></a><a class="code" href="classHepMC_1_1GenVertex_1_1edge__iterator.html#9409a50bd1ebe8bc7105e1bd54f21cf1">00555</a>     <a class="code" href="classHepMC_1_1GenVertex_1_1edge__iterator.html" title="edge iterator">GenVertex::edge_iterator</a> <a class="code" href="classHepMC_1_1GenVertex_1_1edge__iterator.html#f3c926b96624a094b8b9c935d9f769b3" title="Pre-fix increment.">GenVertex::edge_iterator::operator++</a>(<span class="keywordtype">int</span>){
<a name="l00556"></a>00556         <span class="comment">// Post-fix increment</span>
<a name="l00557"></a>00557         <a class="code" href="classHepMC_1_1GenVertex_1_1edge__iterator.html" title="edge iterator">edge_iterator</a> returnvalue = *<span class="keyword">this</span>;
<a name="l00558"></a>00558         ++*<span class="keyword">this</span>;
<a name="l00559"></a>00559         <span class="keywordflow">return</span> returnvalue;
<a name="l00560"></a>00560     }
<a name="l00561"></a>00561 
<a name="l00562"></a><a class="code" href="classHepMC_1_1GenVertex_1_1edge__iterator.html#753ee601017931aa8d7c93d35dcecdc9">00562</a>     <span class="keywordtype">bool</span> <a class="code" href="classHepMC_1_1GenVertex_1_1edge__iterator.html#753ee601017931aa8d7c93d35dcecdc9" title="true if parent of root vtx">GenVertex::edge_iterator::is_parent</a>()<span class="keyword"> const </span>{
<a name="l00563"></a>00563         <span class="keywordflow">if</span> ( **<span class="keyword">this</span> &amp;&amp; (**this)-&gt;end_vertex() == m_vertex ) <span class="keywordflow">return</span> 1;
<a name="l00564"></a>00564         <span class="keywordflow">return</span> 0;
<a name="l00565"></a>00565     }
<a name="l00566"></a>00566 
<a name="l00567"></a><a class="code" href="classHepMC_1_1GenVertex_1_1edge__iterator.html#f64456faada4f8de0e4b5e84875ce231">00567</a>     <span class="keywordtype">bool</span> <a class="code" href="classHepMC_1_1GenVertex_1_1edge__iterator.html#f64456faada4f8de0e4b5e84875ce231" title="true if child of root vtx">GenVertex::edge_iterator::is_child</a>()<span class="keyword"> const </span>{
<a name="l00568"></a>00568         <span class="keywordflow">if</span> ( **<span class="keyword">this</span> &amp;&amp; (**this)-&gt;production_vertex() == m_vertex ) <span class="keywordflow">return</span> 1;
<a name="l00569"></a>00569         <span class="keywordflow">return</span> 0;
<a name="l00570"></a>00570     }
<a name="l00571"></a>00571 
<a name="l00572"></a><a class="code" href="classHepMC_1_1GenVertex.html#6466deb7b92e4437ff4a901300bc73a6">00572</a>     <span class="keywordtype">int</span> <a class="code" href="classHepMC_1_1GenVertex.html#6466deb7b92e4437ff4a901300bc73a6" title="size">GenVertex::edges_size</a>( <a class="code" href="namespaceHepMC.html#4bcb7cab15dc9b703a73e593c3a5e429" title="type of iteration">IteratorRange</a> range )<span class="keyword"> const </span>{
<a name="l00573"></a>00573         <span class="keywordflow">if</span> ( range == <a class="code" href="namespaceHepMC.html#4bcb7cab15dc9b703a73e593c3a5e42959a13a228459c4a4bc3a2751b6ce858b">children</a> ) <span class="keywordflow">return</span> m_particles_out.size();
<a name="l00574"></a>00574         <span class="keywordflow">if</span> ( range == <a class="code" href="namespaceHepMC.html#4bcb7cab15dc9b703a73e593c3a5e42950ded9ccf4b46b12aa937cbdfe79023c">parents</a> ) <span class="keywordflow">return</span> m_particles_in.size();
<a name="l00575"></a>00575         <span class="keywordflow">if</span> ( range == <a class="code" href="namespaceHepMC.html#4bcb7cab15dc9b703a73e593c3a5e42966aca6b4ed534f4cd10b29a86b4137d1">family</a> ) <span class="keywordflow">return</span> m_particles_out.size()
<a name="l00576"></a>00576                                       + m_particles_in.size();
<a name="l00577"></a>00577         <span class="keywordflow">return</span> 0;
<a name="l00578"></a>00578     }
<a name="l00579"></a>00579 
<a name="l00581"></a>00581     <span class="comment">// vertex_iterator //</span>
<a name="l00583"></a>00583 <span class="comment"></span>    
<a name="l00584"></a><a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#8996e798baef5d646eb1012606adc3ad">00584</a>     <a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#8996e798baef5d646eb1012606adc3ad">GenVertex::vertex_iterator::vertex_iterator</a>() 
<a name="l00585"></a>00585         : m_vertex(0), m_range(), m_visited_vertices(0), m_it_owns_set(0), 
<a name="l00586"></a>00586           m_recursive_iterator(0)
<a name="l00587"></a>00587     {}
<a name="l00588"></a>00588 
<a name="l00589"></a><a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#a2ceed8f61f79796653e47d9e24fece0">00589</a>     <a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#8996e798baef5d646eb1012606adc3ad">GenVertex::vertex_iterator::vertex_iterator</a>( <a class="code" href="classHepMC_1_1GenVertex.html" title="GenVertex contains information about decay vertices.">GenVertex</a>&amp; vtx_root,
<a name="l00590"></a>00590                                               <a class="code" href="namespaceHepMC.html#4bcb7cab15dc9b703a73e593c3a5e429" title="type of iteration">IteratorRange</a> <a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#860db56d5e9af2b3c3d9fa6175dd74ce" title="iterator range">range</a> )
<a name="l00591"></a>00591         : m_vertex(&amp;vtx_root), m_range(range) 
<a name="l00592"></a>00592     {
<a name="l00593"></a>00593         <span class="comment">// standard public constructor</span>
<a name="l00594"></a>00594         <span class="comment">//</span>
<a name="l00595"></a>00595         m_visited_vertices = <span class="keyword">new</span> std::set&lt;const GenVertex*&gt;;
<a name="l00596"></a>00596         m_it_owns_set = 1;
<a name="l00597"></a>00597         m_visited_vertices-&gt;insert( m_vertex );
<a name="l00598"></a>00598         m_recursive_iterator = 0;
<a name="l00599"></a>00599         m_edge = m_vertex-&gt;<a class="code" href="classHepMC_1_1GenVertex.html#684c8bdf89e9399972a6b59d0b0be4f3" title="begin range">edges_begin</a>( m_range );
<a name="l00600"></a>00600         <span class="comment">// advance to the first good return value</span>
<a name="l00601"></a>00601         <span class="keywordflow">if</span> ( !<a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#ab33a3213925214c03aae774fb71c59b" title="non-null if recursive iter. created">follow_edge_</a>() &amp;&amp;
<a name="l00602"></a>00602              m_edge != m_vertex-&gt;<a class="code" href="classHepMC_1_1GenVertex.html#0e0582242d8261ae719516afcb8d58a0" title="end range">edges_end</a>( m_range )) ++*<span class="keyword">this</span>;
<a name="l00603"></a>00603     }
<a name="l00604"></a>00604 
<a name="l00605"></a>00605     <a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#8996e798baef5d646eb1012606adc3ad">GenVertex::vertex_iterator::vertex_iterator</a>( <a class="code" href="classHepMC_1_1GenVertex.html" title="GenVertex contains information about decay vertices.">GenVertex</a>&amp; vtx_root,
<a name="l00606"></a>00606         <a class="code" href="namespaceHepMC.html#4bcb7cab15dc9b703a73e593c3a5e429" title="type of iteration">IteratorRange</a> <a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#860db56d5e9af2b3c3d9fa6175dd74ce" title="iterator range">range</a>, std::set&lt;const GenVertex*&gt;&amp; visited_vertices ) :
<a name="l00607"></a>00607         m_vertex(&amp;vtx_root), m_range(range), 
<a name="l00608"></a>00608         m_visited_vertices(&amp;visited_vertices), m_it_owns_set(0),
<a name="l00609"></a>00609         m_recursive_iterator(0) 
<a name="l00610"></a>00610     {
<a name="l00611"></a>00611         <span class="comment">// This constuctor is only to be called internally by this class</span>
<a name="l00612"></a>00612         <span class="comment">//   for use with its recursive member pointer (m_recursive_iterator).</span>
<a name="l00613"></a>00613         <span class="comment">// Note: we do not need to insert m_vertex_root in the vertex - that is</span>
<a name="l00614"></a>00614         <span class="comment">//  the responsibility of this iterator's mother, which is normally</span>
<a name="l00615"></a>00615         <span class="comment">//  done just before calling this protected constructor.</span>
<a name="l00616"></a>00616         m_edge = m_vertex-&gt;<a class="code" href="classHepMC_1_1GenVertex.html#684c8bdf89e9399972a6b59d0b0be4f3" title="begin range">edges_begin</a>( m_range );
<a name="l00617"></a>00617         <span class="comment">// advance to the first good return value</span>
<a name="l00618"></a>00618         <span class="keywordflow">if</span> ( !<a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#ab33a3213925214c03aae774fb71c59b" title="non-null if recursive iter. created">follow_edge_</a>() &amp;&amp;
<a name="l00619"></a>00619              m_edge != m_vertex-&gt;<a class="code" href="classHepMC_1_1GenVertex.html#0e0582242d8261ae719516afcb8d58a0" title="end range">edges_end</a>( m_range )) ++*<span class="keyword">this</span>;
<a name="l00620"></a>00620      }
<a name="l00621"></a>00621 
<a name="l00622"></a><a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#9d93fb7e21b7fa11931e2e6f1bcaa7d4">00622</a>     <a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#8996e798baef5d646eb1012606adc3ad">GenVertex::vertex_iterator::vertex_iterator</a>( <span class="keyword">const</span> <a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html" title="vertex iterator">vertex_iterator</a>&amp; v_iter)
<a name="l00623"></a>00623         : m_vertex(0), m_visited_vertices(0), m_it_owns_set(0), 
<a name="l00624"></a>00624           m_recursive_iterator(0) 
<a name="l00625"></a>00625     {
<a name="l00626"></a>00626         *<span class="keyword">this</span> = v_iter;
<a name="l00627"></a>00627     }
<a name="l00628"></a>00628 
<a name="l00629"></a><a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#75c92b6bb929bd1781181b2ee84f9f2d">00629</a>     <a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#75c92b6bb929bd1781181b2ee84f9f2d">GenVertex::vertex_iterator::~vertex_iterator</a>() {
<a name="l00630"></a>00630         <span class="keywordflow">if</span> ( m_recursive_iterator ) <span class="keyword">delete</span> m_recursive_iterator;
<a name="l00631"></a>00631         <span class="keywordflow">if</span> ( m_it_owns_set ) <span class="keyword">delete</span> m_visited_vertices;
<a name="l00632"></a>00632     }
<a name="l00633"></a>00633 
<a name="l00634"></a><a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#475c7881e73fdce6938815b1d04ffdcf">00634</a>     <a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html" title="vertex iterator">GenVertex::vertex_iterator</a>&amp; <a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#475c7881e73fdce6938815b1d04ffdcf" title="make a copy">GenVertex::vertex_iterator::operator=</a>( 
<a name="l00635"></a>00635         <span class="keyword">const</span> <a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html" title="vertex iterator">vertex_iterator</a>&amp; v_iter ) 
<a name="l00636"></a>00636     {
<a name="l00637"></a>00637         <span class="comment">// Note: when copying a vertex_iterator that is NOT the owner</span>
<a name="l00638"></a>00638         <span class="comment">// of its set container, the pointer to the set is copied. Beware!</span>
<a name="l00639"></a>00639         <span class="comment">// (see copy_with_own_set() if you want a different set pointed to)</span>
<a name="l00640"></a>00640         <span class="comment">// In practise the user never needs to worry</span>
<a name="l00641"></a>00641         <span class="comment">// since such iterators are only intended to be used internally.</span>
<a name="l00642"></a>00642         <span class="comment">//</span>
<a name="l00643"></a>00643         <span class="comment">// destruct data member pointers</span>
<a name="l00644"></a>00644         <span class="keywordflow">if</span> ( m_recursive_iterator ) <span class="keyword">delete</span> m_recursive_iterator;
<a name="l00645"></a>00645         m_recursive_iterator = 0;
<a name="l00646"></a>00646         <span class="keywordflow">if</span> ( m_it_owns_set ) <span class="keyword">delete</span> m_visited_vertices;
<a name="l00647"></a>00647         m_visited_vertices = 0;
<a name="l00648"></a>00648         m_it_owns_set = 0;
<a name="l00649"></a>00649         <span class="comment">// copy the target vertex_iterator to this iterator </span>
<a name="l00650"></a>00650         m_vertex = v_iter.<a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#28f8c0e1a9b43f5baed8d67aadb18100">m_vertex</a>;
<a name="l00651"></a>00651         m_range = v_iter.<a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#5a0957c0c19671f6c50fca2a6737ddf6">m_range</a>;
<a name="l00652"></a>00652         <span class="keywordflow">if</span> ( v_iter.<a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#012c600064c2472f0e851d451bc50961">m_it_owns_set</a> ) {
<a name="l00653"></a>00653             <span class="comment">// i.e. this vertex will own its set if v_iter points to any</span>
<a name="l00654"></a>00654             <span class="comment">// vertex set regardless of whether v_iter owns the set or not!</span>
<a name="l00655"></a>00655             m_visited_vertices = 
<a name="l00656"></a>00656                 <span class="keyword">new</span> std::set&lt;const GenVertex*&gt;(*v_iter.<a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#1843b666922e20898d084d133fa973bb">m_visited_vertices</a>);
<a name="l00657"></a>00657             m_it_owns_set = 1;
<a name="l00658"></a>00658         } <span class="keywordflow">else</span> {
<a name="l00659"></a>00659             m_visited_vertices = v_iter.<a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#1843b666922e20898d084d133fa973bb">m_visited_vertices</a>;
<a name="l00660"></a>00660             m_it_owns_set = 0;
<a name="l00661"></a>00661         }
<a name="l00662"></a>00662         <span class="comment">//</span>
<a name="l00663"></a>00663         <span class="comment">// Note: m_vertex_root is already included in the set of </span>
<a name="l00664"></a>00664         <span class="comment">//  tv_iter.m_visited_vertices, we do not need to insert it.</span>
<a name="l00665"></a>00665         <span class="comment">//</span>
<a name="l00666"></a>00666         m_edge = v_iter.<a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#793d9ac82d9d7884b206cf015a43af77">m_edge</a>;
<a name="l00667"></a>00667         <a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#976cad12c2d24f99bba14a67a702a030" title="copy recursive iterator">copy_recursive_iterator_</a>( v_iter.<a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#59dd97dce091c131bbbbbadbc43dcc71">m_recursive_iterator</a> );
<a name="l00668"></a>00668         <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00669"></a>00669     }
<a name="l00670"></a>00670 
<a name="l00671"></a><a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#4302ed59a3b3d5e94716e3ea09884f81">00671</a>     <a class="code" href="classHepMC_1_1GenVertex.html" title="GenVertex contains information about decay vertices.">GenVertex</a>* <a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#4302ed59a3b3d5e94716e3ea09884f81" title="return a pointer to a vertex">GenVertex::vertex_iterator::operator*</a>(<span class="keywordtype">void</span>)<span class="keyword"> const </span>{
<a name="l00672"></a>00672         <span class="comment">// de-reference operator</span>
<a name="l00673"></a>00673         <span class="comment">//</span>
<a name="l00674"></a>00674         <span class="comment">// if this iterator has an iterator_node, then we return the iterator</span>
<a name="l00675"></a>00675         <span class="comment">// node.</span>
<a name="l00676"></a>00676         <span class="keywordflow">if</span> ( m_recursive_iterator ) <span class="keywordflow">return</span>  **m_recursive_iterator;
<a name="l00677"></a>00677         <span class="comment">//</span>
<a name="l00678"></a>00678         <span class="comment">// an iterator can only return its m_vertex -- any other vertex</span>
<a name="l00679"></a>00679         <span class="comment">//  is returned by means of a recursive iterator_node </span>
<a name="l00680"></a>00680         <span class="comment">//  (so this is the only place in the iterator code that a vertex </span>
<a name="l00681"></a>00681         <span class="comment">//   is returned!) </span>
<a name="l00682"></a>00682         <span class="keywordflow">if</span> ( m_vertex ) <span class="keywordflow">return</span> m_vertex;
<a name="l00683"></a>00683         <span class="keywordflow">return</span> 0;
<a name="l00684"></a>00684     }
<a name="l00685"></a>00685 
<a name="l00686"></a><a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#b3ad44c7d24ed89fe1ec56c9a1a7781f">00686</a>     <a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html" title="vertex iterator">GenVertex::vertex_iterator</a>&amp; <a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#b3ad44c7d24ed89fe1ec56c9a1a7781f" title="Pre-fix increment.">GenVertex::vertex_iterator::operator++</a>(<span class="keywordtype">void</span>) {
<a name="l00687"></a>00687         <span class="comment">// Pre-fix incremental operator</span>
<a name="l00688"></a>00688         <span class="comment">//</span>
<a name="l00689"></a>00689         <span class="comment">// check for "past the end condition" denoted by m_vertex=0</span>
<a name="l00690"></a>00690         <span class="keywordflow">if</span> ( !m_vertex ) <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00691"></a>00691         <span class="comment">// if at the last edge, move into the "past the end condition"</span>
<a name="l00692"></a>00692         <span class="keywordflow">if</span> ( m_edge == m_vertex-&gt;<a class="code" href="classHepMC_1_1GenVertex.html#0e0582242d8261ae719516afcb8d58a0" title="end range">edges_end</a>( m_range ) ) {
<a name="l00693"></a>00693             m_vertex = 0;
<a name="l00694"></a>00694             <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00695"></a>00695         }
<a name="l00696"></a>00696         <span class="comment">// check to see if we need to create a new recursive iterator by</span>
<a name="l00697"></a>00697         <span class="comment">// following the current edge only if a recursive iterator doesn't</span>
<a name="l00698"></a>00698         <span class="comment">// already exist. If a new recursive_iterator is created, return it.</span>
<a name="l00699"></a>00699         <span class="keywordflow">if</span> ( <a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#ab33a3213925214c03aae774fb71c59b" title="non-null if recursive iter. created">follow_edge_</a>() ) {
<a name="l00700"></a>00700               <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00701"></a>00701         }
<a name="l00702"></a>00702         <span class="comment">//</span>
<a name="l00703"></a>00703         <span class="comment">// if a recursive iterator already exists, increment it, and return its</span>
<a name="l00704"></a>00704         <span class="comment">// value (unless the recursive iterator has null root_vertex [its</span>
<a name="l00705"></a>00705         <span class="comment">// root vertex is set to null if it has already returned its root] </span>
<a name="l00706"></a>00706         <span class="comment">// - in which case we delete it) </span>
<a name="l00707"></a>00707         <span class="comment">// and return the vertex pointed to by the edge.</span>
<a name="l00708"></a>00708         <span class="keywordflow">if</span> ( m_recursive_iterator ) {
<a name="l00709"></a>00709             ++(*m_recursive_iterator);
<a name="l00710"></a>00710             <span class="keywordflow">if</span> ( **m_recursive_iterator ) {
<a name="l00711"></a>00711                 <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00712"></a>00712             } <span class="keywordflow">else</span> {
<a name="l00713"></a>00713                 <span class="keyword">delete</span> m_recursive_iterator;
<a name="l00714"></a>00714                 m_recursive_iterator = 0;
<a name="l00715"></a>00715             }
<a name="l00716"></a>00716         }
<a name="l00717"></a>00717         <span class="comment">//</span>
<a name="l00718"></a>00718         <span class="comment">// increment to the next particle edge</span>
<a name="l00719"></a>00719         ++m_edge;
<a name="l00720"></a>00720         <span class="comment">// if m_edge is at the end, then we have incremented through all</span>
<a name="l00721"></a>00721         <span class="comment">// edges, and it is time to return m_vertex, which we accomplish</span>
<a name="l00722"></a>00722         <span class="comment">// by returning *this</span>
<a name="l00723"></a>00723         <span class="keywordflow">if</span> ( m_edge == m_vertex-&gt;<a class="code" href="classHepMC_1_1GenVertex.html#0e0582242d8261ae719516afcb8d58a0" title="end range">edges_end</a>( m_range ) ) <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00724"></a>00724         <span class="comment">// otherwise we follow the current edge by recursively ++ing.</span>
<a name="l00725"></a>00725         <span class="keywordflow">return</span> ++(*this);
<a name="l00726"></a>00726     }
<a name="l00727"></a>00727 
<a name="l00728"></a><a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#39aa6136df496f224d76095e80d33a9a">00728</a>     <a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html" title="vertex iterator">GenVertex::vertex_iterator</a> <a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#b3ad44c7d24ed89fe1ec56c9a1a7781f" title="Pre-fix increment.">GenVertex::vertex_iterator::operator++</a>(<span class="keywordtype">int</span>) {
<a name="l00729"></a>00729         <span class="comment">// Post-fix increment</span>
<a name="l00730"></a>00730         <a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html" title="vertex iterator">vertex_iterator</a> returnvalue(*<span class="keyword">this</span>);
<a name="l00731"></a>00731         ++(*this);
<a name="l00732"></a>00732         <span class="keywordflow">return</span> returnvalue;
<a name="l00733"></a>00733     }
<a name="l00734"></a>00734 
<a name="l00735"></a>00735     <span class="keywordtype">void</span> <a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#42545393a58a1151d75d8d680f7247e4" title="intended for internal use only.">GenVertex::vertex_iterator::copy_with_own_set</a>( 
<a name="l00736"></a>00736         <span class="keyword">const</span> <a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html" title="vertex iterator">vertex_iterator</a>&amp; v_iter, 
<a name="l00737"></a>00737         std::set&lt;const GenVertex*&gt;&amp; visited_vertices ) {
<a name="l00742"></a>00742         <span class="comment">//</span>
<a name="l00743"></a>00743         <span class="comment">// destruct data member pointers</span>
<a name="l00744"></a>00744         <span class="keywordflow">if</span> ( m_recursive_iterator ) <span class="keyword">delete</span> m_recursive_iterator;
<a name="l00745"></a>00745         m_recursive_iterator = 0;
<a name="l00746"></a>00746         <span class="keywordflow">if</span> ( m_it_owns_set ) <span class="keyword">delete</span> m_visited_vertices;
<a name="l00747"></a>00747         m_visited_vertices = 0;
<a name="l00748"></a>00748         m_it_owns_set = 0;
<a name="l00749"></a>00749         <span class="comment">// copy the target vertex_iterator to this iterator </span>
<a name="l00750"></a>00750         m_vertex = v_iter.<a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#28f8c0e1a9b43f5baed8d67aadb18100">m_vertex</a>;
<a name="l00751"></a>00751         m_range = v_iter.<a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#5a0957c0c19671f6c50fca2a6737ddf6">m_range</a>;
<a name="l00752"></a>00752         m_visited_vertices = &amp;visited_vertices;
<a name="l00753"></a>00753         m_it_owns_set = 0;
<a name="l00754"></a>00754         m_edge = v_iter.<a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#793d9ac82d9d7884b206cf015a43af77">m_edge</a>;
<a name="l00755"></a>00755         <a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#976cad12c2d24f99bba14a67a702a030" title="copy recursive iterator">copy_recursive_iterator_</a>( v_iter.<a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#59dd97dce091c131bbbbbadbc43dcc71">m_recursive_iterator</a> );
<a name="l00756"></a>00756     }
<a name="l00757"></a>00757 
<a name="l00758"></a><a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#ab33a3213925214c03aae774fb71c59b">00758</a>     <a class="code" href="classHepMC_1_1GenVertex.html" title="GenVertex contains information about decay vertices.">GenVertex</a>* <a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#ab33a3213925214c03aae774fb71c59b" title="non-null if recursive iter. created">GenVertex::vertex_iterator::follow_edge_</a>() {
<a name="l00759"></a>00759         <span class="comment">// follows the edge pointed to by m_edge by creating a </span>
<a name="l00760"></a>00760         <span class="comment">// recursive iterator for it.</span>
<a name="l00761"></a>00761         <span class="comment">//</span>
<a name="l00762"></a>00762         <span class="comment">// if a m_recursive_iterator already exists, </span>
<a name="l00763"></a>00763         <span class="comment">// this routine has nothing to do,</span>
<a name="l00764"></a>00764         <span class="comment">// if there's no m_vertex, there's no point following anything, </span>
<a name="l00765"></a>00765         <span class="comment">// also there's no point trying to follow a null edge.</span>
<a name="l00766"></a>00766         <span class="keywordflow">if</span> ( m_recursive_iterator || !m_vertex || !*m_edge ) <span class="keywordflow">return</span> 0;
<a name="l00767"></a>00767         <span class="comment">//</span>
<a name="l00768"></a>00768         <span class="comment">// if the range is parents, children, or family (i.e. &lt;= family)</span>
<a name="l00769"></a>00769         <span class="comment">// then only the iterator which owns the set is allowed to create</span>
<a name="l00770"></a>00770         <span class="comment">// recursive iterators (i.e. recursivity is only allowed to go one</span>
<a name="l00771"></a>00771         <span class="comment">// layer deep)</span>
<a name="l00772"></a>00772         <span class="keywordflow">if</span> ( m_range &lt;= <a class="code" href="namespaceHepMC.html#4bcb7cab15dc9b703a73e593c3a5e42966aca6b4ed534f4cd10b29a86b4137d1">family</a> &amp;&amp; m_it_owns_set == 0 ) <span class="keywordflow">return</span> 0;
<a name="l00773"></a>00773         <span class="comment">//</span>
<a name="l00774"></a>00774         <span class="comment">// M.Dobbs 2001-07-16</span>
<a name="l00775"></a>00775         <span class="comment">// Take care of the very special-rare case where a particle might</span>
<a name="l00776"></a>00776         <span class="comment">// point to the same vertex for both production and end</span>
<a name="l00777"></a>00777         <span class="keywordflow">if</span> ( (*m_edge)-&gt;production_vertex() == 
<a name="l00778"></a>00778              (*m_edge)-&gt;end_vertex() ) <span class="keywordflow">return</span> 0;
<a name="l00779"></a>00779         <span class="comment">//</span>
<a name="l00780"></a>00780         <span class="comment">// figure out which vertex m_edge is pointing to</span>
<a name="l00781"></a>00781         <a class="code" href="classHepMC_1_1GenVertex.html" title="GenVertex contains information about decay vertices.">GenVertex</a>* vtx = ( m_edge.<a class="code" href="classHepMC_1_1GenVertex_1_1edge__iterator.html#753ee601017931aa8d7c93d35dcecdc9" title="true if parent of root vtx">is_parent</a>() ? 
<a name="l00782"></a>00782                         (*m_edge)-&gt;production_vertex() :
<a name="l00783"></a>00783                         (*m_edge)-&gt;end_vertex() );
<a name="l00784"></a>00784         <span class="comment">// if the pointed to vertex doesn't exist or has already been visited, </span>
<a name="l00785"></a>00785         <span class="comment">// then return null</span>
<a name="l00786"></a>00786         <span class="keywordflow">if</span> ( !vtx || !(m_visited_vertices-&gt;insert(vtx).second) ) <span class="keywordflow">return</span> 0;
<a name="l00787"></a>00787         <span class="comment">// follow that edge by creating a recursive iterator</span>
<a name="l00788"></a>00788         m_recursive_iterator = <span class="keyword">new</span> <a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#8996e798baef5d646eb1012606adc3ad">vertex_iterator</a>( *vtx, m_range,
<a name="l00789"></a>00789                                                     *m_visited_vertices);
<a name="l00790"></a>00790         <span class="comment">// and return the vertex pointed to by m_recursive_iterator </span>
<a name="l00791"></a>00791         <span class="keywordflow">return</span> **m_recursive_iterator;
<a name="l00792"></a>00792     }
<a name="l00793"></a>00793         
<a name="l00794"></a><a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#976cad12c2d24f99bba14a67a702a030">00794</a>     <span class="keywordtype">void</span> <a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#976cad12c2d24f99bba14a67a702a030" title="copy recursive iterator">GenVertex::vertex_iterator::copy_recursive_iterator_</a>( 
<a name="l00795"></a>00795         <span class="keyword">const</span> <a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html" title="vertex iterator">vertex_iterator</a>* recursive_v_iter ) {
<a name="l00796"></a>00796         <span class="comment">// to properly copy the recursive iterator, we need to ensure</span>
<a name="l00797"></a>00797         <span class="comment">// the proper set container is transfered ... then do this </span>
<a name="l00798"></a>00798         <span class="comment">// operation .... you guessed it .... recursively!</span>
<a name="l00799"></a>00799         <span class="comment">//</span>
<a name="l00800"></a>00800         <span class="keywordflow">if</span> ( !recursive_v_iter ) <span class="keywordflow">return</span>;
<a name="l00801"></a>00801         m_recursive_iterator = <span class="keyword">new</span> <a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#8996e798baef5d646eb1012606adc3ad">vertex_iterator</a>();
<a name="l00802"></a>00802         m_recursive_iterator-&gt;<a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#28f8c0e1a9b43f5baed8d67aadb18100">m_vertex</a> = recursive_v_iter-&gt;<a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#28f8c0e1a9b43f5baed8d67aadb18100">m_vertex</a>;
<a name="l00803"></a>00803         m_recursive_iterator-&gt;<a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#5a0957c0c19671f6c50fca2a6737ddf6">m_range</a> = recursive_v_iter-&gt;<a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#5a0957c0c19671f6c50fca2a6737ddf6">m_range</a>;
<a name="l00804"></a>00804         m_recursive_iterator-&gt;<a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#1843b666922e20898d084d133fa973bb">m_visited_vertices</a> = m_visited_vertices;
<a name="l00805"></a>00805         m_recursive_iterator-&gt;<a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#012c600064c2472f0e851d451bc50961">m_it_owns_set</a> = 0;
<a name="l00806"></a>00806         m_recursive_iterator-&gt;<a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#793d9ac82d9d7884b206cf015a43af77">m_edge</a> = recursive_v_iter-&gt;<a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#793d9ac82d9d7884b206cf015a43af77">m_edge</a>;
<a name="l00807"></a>00807         m_recursive_iterator-&gt;<a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#976cad12c2d24f99bba14a67a702a030" title="copy recursive iterator">copy_recursive_iterator_</a>( 
<a name="l00808"></a>00808             recursive_v_iter-&gt;<a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#59dd97dce091c131bbbbbadbc43dcc71">m_recursive_iterator</a> );
<a name="l00809"></a>00809     }
<a name="l00810"></a>00810 
<a name="l00812"></a>00812     <span class="comment">// particle_iterator         //</span>
<a name="l00814"></a>00814 <span class="comment"></span>
<a name="l00815"></a><a class="code" href="classHepMC_1_1GenVertex_1_1particle__iterator.html#7c5a60d06fa9b718b70161570ee38b92">00815</a>     <a class="code" href="classHepMC_1_1GenVertex_1_1particle__iterator.html#7c5a60d06fa9b718b70161570ee38b92">GenVertex::particle_iterator::particle_iterator</a>() {}
<a name="l00816"></a>00816 
<a name="l00817"></a><a class="code" href="classHepMC_1_1GenVertex_1_1particle__iterator.html#f30f9f77a3bb4e72fb59e81341062460">00817</a>     <a class="code" href="classHepMC_1_1GenVertex_1_1particle__iterator.html#7c5a60d06fa9b718b70161570ee38b92">GenVertex::particle_iterator::particle_iterator</a>( <a class="code" href="classHepMC_1_1GenVertex.html" title="GenVertex contains information about decay vertices.">GenVertex</a>&amp; vertex_root,
<a name="l00818"></a>00818                                                      <a class="code" href="namespaceHepMC.html#4bcb7cab15dc9b703a73e593c3a5e429" title="type of iteration">IteratorRange</a> range ) {
<a name="l00819"></a>00819         <span class="comment">// General Purpose Constructor</span>
<a name="l00820"></a>00820         <span class="comment">//</span>
<a name="l00821"></a>00821         <span class="keywordflow">if</span> ( range &lt;= <a class="code" href="namespaceHepMC.html#4bcb7cab15dc9b703a73e593c3a5e42966aca6b4ed534f4cd10b29a86b4137d1">family</a> ) {
<a name="l00822"></a>00822             m_edge = <a class="code" href="classHepMC_1_1GenVertex_1_1edge__iterator.html" title="edge iterator">GenVertex::edge_iterator</a>( vertex_root, range ); 
<a name="l00823"></a>00823         } <span class="keywordflow">else</span> {
<a name="l00824"></a>00824             m_vertex_iterator = <a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html" title="vertex iterator">GenVertex::vertex_iterator</a>(vertex_root, range);
<a name="l00825"></a>00825             m_edge = <a class="code" href="classHepMC_1_1GenVertex_1_1edge__iterator.html" title="edge iterator">GenVertex::edge_iterator</a>( **m_vertex_iterator, 
<a name="l00826"></a>00826                                                   m_vertex_iterator.<a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#860db56d5e9af2b3c3d9fa6175dd74ce" title="iterator range">range</a>() ); 
<a name="l00827"></a>00827         }
<a name="l00828"></a>00828         <a class="code" href="classHepMC_1_1GenVertex_1_1particle__iterator.html#9795742185a5a683ca647aedd52cd5eb" title=""first" particle">advance_to_first_</a>();
<a name="l00829"></a>00829     }
<a name="l00830"></a>00830 
<a name="l00831"></a><a class="code" href="classHepMC_1_1GenVertex_1_1particle__iterator.html#1a4878d06d0f9356d9fd0e4f240baeeb">00831</a>     <a class="code" href="classHepMC_1_1GenVertex_1_1particle__iterator.html#7c5a60d06fa9b718b70161570ee38b92">GenVertex::particle_iterator::particle_iterator</a>( 
<a name="l00832"></a>00832         <span class="keyword">const</span> <a class="code" href="classHepMC_1_1GenVertex_1_1particle__iterator.html" title="particle iterator">particle_iterator</a>&amp; p_iter ){
<a name="l00833"></a>00833         *<span class="keyword">this</span> = p_iter;
<a name="l00834"></a>00834     }
<a name="l00835"></a>00835 
<a name="l00836"></a><a class="code" href="classHepMC_1_1GenVertex_1_1particle__iterator.html#d3f9cdfcbb1c69c8eab15f80c0840dc8">00836</a>     <a class="code" href="classHepMC_1_1GenVertex_1_1particle__iterator.html#d3f9cdfcbb1c69c8eab15f80c0840dc8">GenVertex::particle_iterator::~particle_iterator</a>() {}
<a name="l00837"></a>00837 
<a name="l00838"></a>00838     <a class="code" href="classHepMC_1_1GenVertex_1_1particle__iterator.html" title="particle iterator">GenVertex::particle_iterator</a>&amp; 
<a name="l00839"></a><a class="code" href="classHepMC_1_1GenVertex_1_1particle__iterator.html#8341961f15362bdd765d88217eb5c58d">00839</a>     <a class="code" href="classHepMC_1_1GenVertex_1_1particle__iterator.html#8341961f15362bdd765d88217eb5c58d" title="make a copy">GenVertex::particle_iterator::operator=</a>( <span class="keyword">const</span> <a class="code" href="classHepMC_1_1GenVertex_1_1particle__iterator.html" title="particle iterator">particle_iterator</a>&amp; p_iter )
<a name="l00840"></a>00840     {
<a name="l00841"></a>00841         m_vertex_iterator = p_iter.<a class="code" href="classHepMC_1_1GenVertex_1_1particle__iterator.html#0adaba02c03e822251e8908870595158">m_vertex_iterator</a>;
<a name="l00842"></a>00842         m_edge = p_iter.<a class="code" href="classHepMC_1_1GenVertex_1_1particle__iterator.html#551bb2a2cc0e9cc4aa99b545a2bac7fb">m_edge</a>;
<a name="l00843"></a>00843         <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00844"></a>00844     }
<a name="l00845"></a>00845 
<a name="l00846"></a><a class="code" href="classHepMC_1_1GenVertex_1_1particle__iterator.html#5dbe03830cc9e018aedd0e9c3b0b220a">00846</a>     <a class="code" href="classHepMC_1_1GenParticle.html" title="The GenParticle class contains information about generated particles.">GenParticle</a>* <a class="code" href="classHepMC_1_1GenVertex_1_1particle__iterator.html#5dbe03830cc9e018aedd0e9c3b0b220a" title="return a pointer to a particle">GenVertex::particle_iterator::operator*</a>(<span class="keywordtype">void</span>)<span class="keyword"> const </span>{
<a name="l00847"></a>00847         <span class="keywordflow">return</span> *m_edge;
<a name="l00848"></a>00848     }
<a name="l00849"></a>00849 
<a name="l00850"></a>00850     <a class="code" href="classHepMC_1_1GenVertex_1_1particle__iterator.html" title="particle iterator">GenVertex::particle_iterator</a>&amp; 
<a name="l00851"></a><a class="code" href="classHepMC_1_1GenVertex_1_1particle__iterator.html#fdbae6accd220313f2fb349aee188c49">00851</a>     <a class="code" href="classHepMC_1_1GenVertex_1_1particle__iterator.html#fdbae6accd220313f2fb349aee188c49" title="Pre-fix increment.">GenVertex::particle_iterator::operator++</a>(<span class="keywordtype">void</span>) {
<a name="l00852"></a>00852         <span class="comment">//Pre-fix increment </span>
<a name="l00853"></a>00853         <span class="comment">//</span>
<a name="l00854"></a>00854         <span class="keywordflow">if</span> ( !*m_edge &amp;&amp; !*m_vertex_iterator ) {
<a name="l00855"></a>00855             <span class="comment">// past the end condition: do nothing</span>
<a name="l00856"></a>00856             <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00857"></a>00857         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( !*m_edge &amp;&amp; *m_vertex_iterator ) {
<a name="l00858"></a>00858             <span class="comment">// past end of edge, but still have more vertices to visit</span>
<a name="l00859"></a>00859             <span class="comment">// increment the vertex, checking that the result is valid</span>
<a name="l00860"></a>00860             <span class="keywordflow">if</span> ( !*(++m_vertex_iterator) ) <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00861"></a>00861             m_edge = <a class="code" href="classHepMC_1_1GenVertex_1_1edge__iterator.html" title="edge iterator">GenVertex::edge_iterator</a>( **m_vertex_iterator, 
<a name="l00862"></a>00862                                                   m_vertex_iterator.<a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#860db56d5e9af2b3c3d9fa6175dd74ce" title="iterator range">range</a>() ); 
<a name="l00863"></a>00863         } <span class="keywordflow">else</span> {
<a name="l00864"></a>00864             ++m_edge;
<a name="l00865"></a>00865         }
<a name="l00866"></a>00866         <a class="code" href="classHepMC_1_1GenVertex_1_1particle__iterator.html#9795742185a5a683ca647aedd52cd5eb" title=""first" particle">advance_to_first_</a>();
<a name="l00867"></a>00867         <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00868"></a>00868     }
<a name="l00869"></a>00869 
<a name="l00870"></a><a class="code" href="classHepMC_1_1GenVertex_1_1particle__iterator.html#24dddc010d733718ac9cd1c5f84403b2">00870</a>     <a class="code" href="classHepMC_1_1GenVertex_1_1particle__iterator.html" title="particle iterator">GenVertex::particle_iterator</a> <a class="code" href="classHepMC_1_1GenVertex_1_1particle__iterator.html#fdbae6accd220313f2fb349aee188c49" title="Pre-fix increment.">GenVertex::particle_iterator::operator++</a>(<span class="keywordtype">int</span>){
<a name="l00871"></a>00871         <span class="comment">//Post-fix increment</span>
<a name="l00872"></a>00872         <a class="code" href="classHepMC_1_1GenVertex_1_1particle__iterator.html" title="particle iterator">particle_iterator</a> returnvalue(*<span class="keyword">this</span>);
<a name="l00873"></a>00873         ++(*this);
<a name="l00874"></a>00874         <span class="keywordflow">return</span> returnvalue;
<a name="l00875"></a>00875     }
<a name="l00876"></a>00876 
<a name="l00877"></a><a class="code" href="classHepMC_1_1GenVertex_1_1particle__iterator.html#9795742185a5a683ca647aedd52cd5eb">00877</a>     <a class="code" href="classHepMC_1_1GenParticle.html" title="The GenParticle class contains information about generated particles.">GenParticle</a>* <a class="code" href="classHepMC_1_1GenVertex_1_1particle__iterator.html#9795742185a5a683ca647aedd52cd5eb" title=""first" particle">GenVertex::particle_iterator::advance_to_first_</a>() {
<a name="l00881"></a>00881         <span class="keywordflow">if</span> ( !*m_edge ) <span class="keywordflow">return</span> *(++*<span class="keyword">this</span>);
<a name="l00882"></a>00882         <span class="comment">// if the range is relatives, we need to uniquely assign each particle</span>
<a name="l00883"></a>00883         <span class="comment">// to a single vertex so as to guarantee particles are returned</span>
<a name="l00884"></a>00884         <span class="comment">// exactly once.</span>
<a name="l00885"></a>00885         <span class="keywordflow">if</span> ( m_vertex_iterator.<a class="code" href="classHepMC_1_1GenVertex_1_1vertex__iterator.html#860db56d5e9af2b3c3d9fa6175dd74ce" title="iterator range">range</a>() == <a class="code" href="namespaceHepMC.html#4bcb7cab15dc9b703a73e593c3a5e4299ab6540f86ad94480d1a8c6efe9c641b">relatives</a> &amp;&amp;
<a name="l00886"></a>00886              m_edge.<a class="code" href="classHepMC_1_1GenVertex_1_1edge__iterator.html#753ee601017931aa8d7c93d35dcecdc9" title="true if parent of root vtx">is_parent</a>() &amp;&amp; 
<a name="l00887"></a>00887              (*m_edge)-&gt;production_vertex() ) <span class="keywordflow">return</span> *(++*<span class="keyword">this</span>);
<a name="l00888"></a>00888         <span class="keywordflow">return</span> *m_edge;
<a name="l00889"></a>00889     }
<a name="l00890"></a>00890 
<a name="l00891"></a>00891 } <span class="comment">// HepMC</span>
</pre></div><hr size="1"><address style="text-align: right;"><small>Generated on Tue Oct 23 17:05:35 2007 for HepMC by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1-3 </small></address>
</body>
</html>
